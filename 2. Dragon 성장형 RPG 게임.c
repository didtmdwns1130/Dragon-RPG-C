#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <termios.h>
#include <string.h>
#include <time.h>
#include <fcntl.h>
#include <stdbool.h>

// ë§µ ì‚¬ì´ì¦ˆ
#define ROW 20
#define COL 40
#define MAX_FIREBALLS 20
#define MAX_MONSTERS 20
#define MONSTER_MOVE_DELAY 50 // ëª¬ìŠ¤í„° ì´ë™ ì£¼ê¸° (í”„ë ˆì„ ë‹¨ìœ„)
#define MONSTER_SHOOT_DELAY 50 // ëª¬ìŠ¤í„° íƒ„í™˜ ë°œì‚¬ ì£¼ê¸° (í”„ë ˆì„ ë‹¨ìœ„)
#define MONSTER_BULLET_MOVE_DELAY 3  // ìˆ«ìê°€ í´ìˆ˜ë¡ íƒ„í™˜ ì´ë™ ëŠë ¤ì§
#define MONSTER_RESPAWN_DELAY 300

// í”Œë ˆì´ì–´ ìœ„ì¹˜ ì „ì—­ ë³€ìˆ˜
int playerX = 1, playerY = 18;

// ë“œë˜ê³¤ ë¸Œë ˆìŠ¤ ì „ì—­ë³€ìˆ˜
int dirX = 1;
int dirY = 0;


// ë¦¬ì   ì „ì—­ ë³€ìˆ˜
int monsterRespawnTimer[MAX_MONSTERS] = {0};
int monsterOriginX[MAX_MONSTERS];
int monsterOriginY[MAX_MONSTERS];

// í€˜ìŠ¤íŠ¸ ì „ì—­ ë³€ìˆ˜
int queststop = 0;
int rewardGiven[5] = {0}; // í€˜ìŠ¤íŠ¸ë³„ ë³´ìƒ ì§€ê¸‰ ì—¬ë¶€ ì¶”ì 
int questAccepted[5] = {0};    // í€˜ìŠ¤íŠ¸ ìˆ˜ë½ ì—¬ë¶€
int questCompleted[5] = {0};   // í€˜ìŠ¤íŠ¸ ì™„ë£Œ ì—¬ë¶€
int questKillCount[5] = {0};   // ê° í€˜ìŠ¤íŠ¸ ì²˜ì¹˜ ìˆ˜
int questItemCount[5] = {0};   // ê° í€˜ìŠ¤íŠ¸ ì•„ì´í…œ ìˆ˜
int inventory[10] = {0};       // ì—¬ì˜ì£¼
int hasKey = 0; // íˆë“  ë§µ í‚¤

// í”Œë ˆì´ì–´ ì´ëª¨ì§€ ì„¤ì •
int currentEmoji = 0;  // 0: ë±€ ğŸ, 1: ìš© ğŸ‰
char* playerEmojis[] = {"ğŸ ", "ğŸ‰ "};

// ëª¬ìŠ¤í„° ì´ëª¨ì§€ ì„¤ì •
const char* monsterEmojis[5] = {
    "ğŸŒ",  // ë˜ì „ 1: ë‹¬íŒ½ì´
    "ğŸ¦",  // ë˜ì „ 2: ë„ë§ˆë±€
    "ğŸ•·ï¸ ", // ë˜ì „ 3: ë§¹ë… ê±°ë¯¸
    "ğŸ§›",  // ë˜ì „ 4: ë“œë¼í˜ë¼
    "ğŸ¦–"   // ë˜ì „ 5: í˜¼í…Œì¼
};

// ëª¬ìŠ¤í„° êµ¬ì¡°ì²´
typedef struct {
    int x, y;
    int hp;
    int alive;
    int move_counter;
    int shoot_counter;
    int type;  // âœ… ëª¬ìŠ¤í„° ì¢…ë¥˜ (0 = ë‹¬íŒ½ì´, 1 =ë„ë§ˆë±€, ...)
    
} Monster;

Monster monsters[MAX_MONSTERS];
int monsterCount = 0;

// íŒŒì´ì–´ë³¼ ë° ëª¬ìŠ¤í„° íƒ„í™˜ êµ¬ì¡°ì²´
typedef struct {
    int x, y;
    int dx, dy;
    int active;
    int is_monster_bullet;
    int damage;  // ğŸ’¥ ìŠ¤í‚¬ ë°ë¯¸ì§€ ì €ì¥ìš©
    int move_counter;
} Fireball;

Fireball fireballs[MAX_FIREBALLS];

// í„°ë¯¸ë„ ì„¤ì • ë°±ì—…ìš© êµ¬ì¡°ì²´
struct termios orig_termios;

// ëª¬ìŠ¤í„° ìƒì„± í•¨ìˆ˜
void spawnMonster(int x, int y, int type) {
    if (monsterCount < MAX_MONSTERS) {
        monsters[monsterCount].x = x;
        monsters[monsterCount].y = y;
        monsters[monsterCount].alive = 1;
        monsterOriginX[monsterCount] = monsters[monsterCount].x;    //ë¦¬ì  
        monsterOriginY[monsterCount] = monsters[monsterCount].y;    //ë¦¬ì  
        monsters[monsterCount].move_counter = 0;
        monsters[monsterCount].shoot_counter = 0;
        monsters[monsterCount].type = type; // íƒ€ì… í• ë‹¹
        // ëª¬ìŠ¤í„° hp ì¡°ì •
        switch (type) {
            case 0: monsters[monsterCount].hp = 20; break;  // ë‹¬íŒ½ì´
            case 1: monsters[monsterCount].hp = 40; break;  // ë„ë§ˆë±€
            case 2: monsters[monsterCount].hp = 80; break;  // ë§¹ë… ê±°ë¯¸
            case 3: monsters[monsterCount].hp = 500; break;  // ë“œë¼í˜ë¼ (íˆë“ )
            case 4: monsters[monsterCount].hp = 1000; break;  // í˜¼í…Œì¼ (ë³´ìŠ¤)
            default: monsters[monsterCount].hp = 20; break;
        }
        monsterCount++;
    }
}

// íŒŒì´ì–´ë³¼/íƒ„í™˜ ìƒì„± í•¨ìˆ˜
void spawnFireball(int x, int y, int dx, int dy, int is_monster_bullet, int damage) {
    for (int i = 0; i < MAX_FIREBALLS; i++) {
        if (!fireballs[i].active) {
            fireballs[i].active = true;
            fireballs[i].x = x;
            fireballs[i].y = y;
            fireballs[i].dx = dx;
            fireballs[i].dy = dy;
            fireballs[i].is_monster_bullet = is_monster_bullet;
            fireballs[i].damage = damage;  // ğŸ’¥ ë°ë¯¸ì§€ ì„¤ì •
            break;
        }
    }
}

// ë©”í…Œì˜¤ ìŠ¤í‚¬
void castMeteor() {
    if (strcmp(playerEmojis[currentEmoji], "ğŸ‰ ") != 0) return;  // ìš©ì´ ì•„ë‹ˆë©´ ìŠ¤í‚¬ ì·¨ì†Œ

    for (int i = 0; i < 10; i++) { // ì´ 10ë°œ ë‚™í•˜
        int mx = rand() % COL;
        int my = 0;
        spawnFireball(mx, my, 0, 1, 0, 50); // ë©”í…Œì˜¤ ìŠ¤í‚¬ ë°ë¯¸ì§€ ìˆ˜ì •
    }

}

// ë“œë˜ê³¤ ë¸Œë ˆìŠ¤ ìŠ¤í‚¬ 
void castDragonBreath(int px, int py, int last_dx, int last_dy, int is_monster_bullet) {
    int offsets[9][2] = {
        {-1, -1}, {0, -1}, {1, -1},
        {-1,  0}, {0,  0}, {1,  0},
        {-1,  1}, {0,  1}, {1,  1}
    };
    if (strcmp(playerEmojis[currentEmoji], "ğŸ‰ ") != 0) return;  // ìš©ì¼ ë•Œë§Œ ë°œë™

    for (int i = 0; i < 9; i++) {
        int fire_x = px + offsets[i][0] + last_dx;
        int fire_y = py + offsets[i][1] + last_dy;
        spawnFireball(fire_x, fire_y, last_dx, last_dy, is_monster_bullet, 20); // ë“œë˜ê³¤ ë¸Œë ˆìŠ¤ ìŠ¤í‚¬ ë°ë¯¸ì§€ ìˆ˜ì •
    }
}


// ëª¬ìŠ¤í„° ì´ë™ ë° íƒ„í™˜ ë°œì‚¬ í•¨ìˆ˜ (ì¶”ê°€)
void updateMonsters(int playerX, int playerY, char map[ROW][COL]) {
    for (int m = 0; m < monsterCount; m++) {
    if (!monsters[m].alive) {
        if (monsterRespawnTimer[m] > 0) {
            monsterRespawnTimer[m]--;
        } else if (monsterRespawnTimer[m] == 0 && monsters[m].type <= 2) {
            monsters[m].x = monsterOriginX[m];
            monsters[m].y = monsterOriginY[m];
            // ëª¬ìŠ¤í„°ê°€ ë¦¬ì   í›„ ì²´ë ¥
            switch (monsters[m].type) {
                case 0: monsters[m].hp = 20; break;
                case 1: monsters[m].hp = 40; break;
                case 2: monsters[m].hp = 80; break;
                case 3: monsters[m].hp = 500; break;
                case 4: monsters[m].hp = 100; break;
                default: monsters[m].hp = 20; break;
            }
            monsters[m].alive = 1;
            monsters[m].move_counter = 0;
            monsters[m].shoot_counter = 0;
        }
        continue;
    }

        // ì´ë™ ì²˜ë¦¬
        monsters[m].move_counter++;
        if (monsters[m].move_counter >= MONSTER_MOVE_DELAY) {
            monsters[m].move_counter = 0;
            int dx = 0, dy = 0;
            if (monsters[m].x < playerX) dx = 1;
            else if (monsters[m].x > playerX) dx = -1;
            if (monsters[m].y < playerY) dy = 1;
            else if (monsters[m].y > playerY) dy = -1;

            int newX = monsters[m].x + dx;
            int newY = monsters[m].y + dy;

            // ë²½, ì¥ì• ë¬¼, í”Œë ˆì´ì–´ ìœ„ì¹˜, ë‹¤ë¥¸ ëª¬ìŠ¤í„°ì™€ ì¶©ëŒ ì²´í¬
            if (newX >= 0 && newX < COL && newY >= 0 && newY < ROW &&
                map[newY][newX] != '1' && map[newY][newX] != '2' &&
                !(newX == playerX && newY == playerY)) {
                int can_move = 1;
                for (int k = 0; k < monsterCount; k++) {
                    if (k != m && monsters[k].alive && monsters[k].x == newX && monsters[k].y == newY) {
                        can_move = 0;
                        break;
                    }
                }
                if (can_move) {
                    monsters[m].x = newX;
                    monsters[m].y = newY;
                }
            }
        }

        // íƒ„í™˜ ë°œì‚¬ ì²˜ë¦¬
        monsters[m].shoot_counter++;
        if (monsters[m].shoot_counter >= MONSTER_SHOOT_DELAY) {
            monsters[m].shoot_counter = 0;
            int dx = 0, dy = 0;
            if (monsters[m].x < playerX) dx = 1;
            else if (monsters[m].x > playerX) dx = -1;
            if (monsters[m].y < playerY) dy = 1;
            else if (monsters[m].y > playerY) dy = -1;
            if (dx != 0 || dy != 0) {
                int sx = monsters[m].x + dx;
                int sy = monsters[m].y + dy;
                if (sx >= 0 && sx < COL && sy >= 0 && sy < ROW) {
                    spawnFireball(sx, sy, dx, dy, 1, 10);  // âœ… ê²¹ì¹˜ì§€ ì•Šê²Œ ë°œì‚¬, ğŸ’¥ ëª¬ìŠ¤í„° íƒ„í™˜ì€ ì˜ˆë¥¼ ë“¤ì–´ 10 ë°ë¯¸ì§€
                }
            }
        }
    }
}

void updateFireballs(char map[ROW][COL], int *playerHP, int *playerMaxHP, int playerX, int playerY) {
    
    for (int i = 0; i < MAX_FIREBALLS; i++) {
        if (fireballs[i].active) {
            int newX = fireballs[i].x + fireballs[i].dx;
            int newY = fireballs[i].y + fireballs[i].dy;

            if (newX < 0 || newX >= COL || newY < 0 || newY >= ROW || map[newY][newX] == '1') {
                fireballs[i].active = 0;
            } else {
                // í”Œë ˆì´ì–´ì˜ íŒŒì´ì–´ë³¼ì´ ëª¬ìŠ¤í„°ì— ë§ì•˜ëŠ”ì§€ í™•ì¸
                if (!fireballs[i].is_monster_bullet) {
                    for (int m = 0; m < monsterCount; m++) {
                        if (monsters[m].alive && monsters[m].x == newX && monsters[m].y == newY) {
                            monsters[m].hp -= fireballs[i].damage;  // âœ… ë°œì‚¬ì²´ê°€ ê°€ì§„ ë°ë¯¸ì§€ë¥¼ ì‚¬ìš©
                            if (monsters[m].hp <= 0) {
                                monsters[m].alive = 0;
                                monsterRespawnTimer[m] = MONSTER_RESPAWN_DELAY;
                                int type = monsters[m].type;

                                // í€˜ìŠ¤íŠ¸ 1: ë‹¬íŒ½ì´
                                if (type == 0 && questAccepted[0] && !questCompleted[0]) {
                                    if (questKillCount[0] < 10) questKillCount[0]++;
                                    if (questItemCount[0] < 5 && rand() % 100 < 50) questItemCount[0]++; // í™•ë¥ ë¡œ ì•„ì´í…œ íšë“
                                    if (questKillCount[0] >= 10 && questItemCount[0] >= 5) {
                                        if(queststop <= 0){
                                            printf("\nğŸ“œ [í€˜ìŠ¤íŠ¸ 1] ëª©í‘œ ë‹¬ì„±! NPCì—ê²Œ ëŒì•„ê°€ì„¸ìš”.\n");
                                            usleep(1000000);
                                            queststop += 1;
                                        }
                                    }
                                }

                                // í€˜ìŠ¤íŠ¸ 2: ë„ë§ˆë±€
                                if (type == 1 && questAccepted[1] && !questCompleted[1]) {
                                    if (questKillCount[1] < 10) questKillCount[1]++;
                                    if (questItemCount[1] < 5 && rand() % 100 < 50) questItemCount[1]++; // í™•ë¥ ë¡œ ì•„ì´í…œ íšë“                                
                                    if (questKillCount[1] >= 10 && questItemCount[1] >= 5) {
                                        if(queststop <= 1){
                                            printf("\nğŸ“œ [í€˜ìŠ¤íŠ¸ 2] ëª©í‘œ ë‹¬ì„±! NPCì—ê²Œ ëŒì•„ê°€ì„¸ìš”.\n");
                                            usleep(1000000);
                                            queststop += 1;
                                        }
                                    }
                                }

                                // í€˜ìŠ¤íŠ¸ 3: ë§¹ë… ê±°ë¯¸
                                if (type == 2 && questAccepted[2] && !questCompleted[2]) {
                                    if (questKillCount[2] < 10) questKillCount[2]++;
                                    if (questItemCount[2] < 5 && rand() % 100 < 50) questItemCount[2]++; // í™•ë¥ ë¡œ ì•„ì´í…œ íšë“                                
                                    if (questKillCount[2] >= 10 && questItemCount[2] >= 5) {
                                        if(queststop <= 2){
                                            printf("\nğŸ“œ [í€˜ìŠ¤íŠ¸ 3] ëª©í‘œ ë‹¬ì„±! NPCì—ê²Œ ëŒì•„ê°€ì„¸ìš”.\n");
                                            usleep(1000000);
                                            queststop += 1;
                                        }
                                    }
                                }

                                // ë˜ì „ 3 ëª¬ìŠ¤í„° (ë§¹ë… ê±°ë¯¸) ì²˜ì¹˜ ì‹œ, 19% í™•ë¥ ë¡œ ì—´ì‡  ë“œë
                                if (type == 2 && rand() % 100 < 19 && !hasKey) {
                                    hasKey = 1;
                                    printf("\nğŸ—ï¸  ë§¹ë… ê±°ë¯¸ê°€ íˆë“  ë˜ì „ì˜ ì—´ì‡ ë¥¼ ë–¨ì–´ëœ¨ë ¸ìŠµë‹ˆë‹¤!\n");
                                    usleep(1500000);
                                }

                                // í€˜ìŠ¤íŠ¸ 4: ë“œë¼í˜ë¼
                                if (type == 3 && questAccepted[3] && !questCompleted[3]) {
                                    questKillCount[3]++;
                                    questItemCount[3]++;
                                    if (questKillCount[3] >= 1 && questItemCount[3] >= 1) {
                                        printf("\nğŸ“œ [í€˜ìŠ¤íŠ¸ 4] ëª©í‘œ ë‹¬ì„±! NPCì—ê²Œ ëŒì•„ê°€ì„¸ìš”.\n");
                                        usleep(1000000);
                                    }
                                }

                                // í€˜ìŠ¤íŠ¸ 5: í˜¼í…Œì¼
                                if (type == 4 && questAccepted[4] && !questCompleted[4]) {
                                    questKillCount[4]++;
                                    questItemCount[4]++;
                                    if (questKillCount[4] >= 1 && questItemCount[4] >= 1) {
                                        printf("\nğŸ“œ [í€˜ìŠ¤íŠ¸ 5] ëª©í‘œ ë‹¬ì„±! NPCì—ê²Œ ëŒì•„ê°€ì„¸ìš”.\n");
                                        usleep(1500000);
                                    }
                                }

                                fireballs[i].active = 0;
                                goto skip_update;
                            }
                        }
                    }
                }

                // ëª¬ìŠ¤í„° íƒ„í™˜ì´ í”Œë ˆì´ì–´ì— ë§ì•˜ëŠ”ì§€ í™•ì¸
                if (fireballs[i].is_monster_bullet && newX == playerX && newY == playerY) {
                    
                    if (monsters[i].type == 0)
                        *playerHP -= 20;
                    if (monsters[i].type == 1)
                        *playerHP -= 40;
                    if (monsters[i].type == 2)
                        *playerHP -= 80;
                    if (monsters[i].type == 3)
                        *playerHP -= 500;
                    if (monsters[i].type == 4)
                        *playerHP -= 1000;
                    
                    if (*playerHP < 0) *playerHP = 0;
                    fireballs[i].active = 0;
                    goto skip_update;
                }
                static int monsterBulletFrameCounter = 0;
                monsterBulletFrameCounter++;
                if (fireballs[i].is_monster_bullet) {
                    fireballs[i].move_counter++;
                    if (fireballs[i].move_counter % MONSTER_BULLET_MOVE_DELAY != 0) {
                        continue;
                    }
                }

                // ìœ„ì¹˜ ê°±ì‹ 
                fireballs[i].x = newX;
                fireballs[i].y = newY;
            }
        }
        skip_update:;
    }
}

void disableRawMode() {
    tcsetattr(STDIN_FILENO, TCSAFLUSH, &orig_termios);
}

void enableRawMode() {
    tcgetattr(STDIN_FILENO, &orig_termios);
    atexit(disableRawMode);
    struct termios raw = orig_termios;
    raw.c_lflag &= ~(ECHO | ICANON);
    tcsetattr(STDIN_FILENO, TCSAFLUSH, &raw);
}

char getch_nonblock() {
    char c = 0;
    int flags = fcntl(STDIN_FILENO, F_GETFL, 0);
    fcntl(STDIN_FILENO, F_SETFL, flags | O_NONBLOCK);
    read(STDIN_FILENO, &c, 1);
    fcntl(STDIN_FILENO, F_SETFL, flags);
    return c;
}

char getch() {
    char c;
    if (read(STDIN_FILENO, &c, 1) == 1)
        return c;
    else
        return 0;
}

void openPotionShop(int* gold, int* potion1_hp, int* potion2_hp, int* potion3_hp) {
    char choice;
    while (1) {
        printf("\033[H\033[J");
        printf("\n---------- ğŸ¥ ë¬¼ì•½ ìƒì ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! ----------\n");
        printf("\n");
        printf("                   ë³´ìœ  ê³¨ë“œ: ğŸ’° %dG\n", *gold);
        printf("\n");
        printf("              1. í•˜ê¸‰ ì²´ë ¥ ë¬¼ì•½ (ğŸ’š ) - 10G\n");
        printf("                  - ì²´ë ¥ íšŒë³µëŸ‰ + 10          \n\n");
        printf("              2. ì¤‘ê¸‰ ì²´ë ¥ ë¬¼ì•½ (ğŸ’™ ) - 30g\n");
        printf("                  - ì²´ë ¥ íšŒë³µëŸ‰ + 30          \n\n");
        printf("              3. ìƒê¸‰ ì²´ë ¥ ë¬¼ì•½ (ğŸ’– ) - 100g\n");
        printf("                  - ì²´ë ¥ íšŒë³µëŸ‰ + 70          \n\n");
        printf("              4. ë‚˜ê°€ê¸°\n");
        printf("\n");
        printf("----------------------------------------------------------\n");
        
        choice = getch();
        if (choice == 0x1b) {
            getch(); getch();
            continue;
        }

        if (choice == '1') {
            if (*gold >= 10) {
                *gold -= 10;
                (*potion1_hp)++;
                printf("ğŸ’š í•˜ê¸‰ ì²´ë ¥ ë¬¼ì•½ì„ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤! (ë‚¨ì€ ê³¨ë“œ: %dG)\n", *gold);
            } else {
                printf("â— ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!\n");
            }
        } else if (choice == '2') {
            if (*gold >= 30) {
                *gold -= 30;
                (*potion2_hp)++;
                printf("ğŸ’™ ì¤‘ê¸‰ ì²´ë ¥ ë¬¼ì•½ì„ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤! (ë‚¨ì€ ê³¨ë“œ: %dG)\n", *gold);
            } else {
                printf("â— ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!\n");
            }
        } else if (choice == '3') {
            if (*gold >= 100) {
                *gold -= 100;
                (*potion3_hp)++;
                printf("ğŸ’– ìƒê¸‰ ì²´ë ¥ ë¬¼ì•½ì„ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤! (ë‚¨ì€ ê³¨ë“œ: %dG)\n", *gold);
            } else {
                printf("â— ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!\n");
            }
        } else if (choice == '4') {
            printf("ìƒì ì„ ë‚˜ê°‘ë‹ˆë‹¤...\n");
            usleep(1000000);
            break;
        } else {
            printf("â— ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.\n");
        }
        usleep(1000000);
    }
}

void playCasino(int* gold) {
    int bet = 0;
    int num[3];
    int reward = 0;
    char ch;

    if (*gold < 10) {
        printf("\nğŸ’¸ ìµœì†Œ 10G ì´ìƒ ìˆì–´ì•¼ ìŠ¬ë¡¯ë¨¸ì‹ ì„ ëŒë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤!\n");
        printf("ê²Œì„ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤...\n");
        usleep(1000000);
        return;
    }

    while (1) {
        if (*gold <= 0) {
            printf("\nğŸ’¸ ê³¨ë“œê°€ ëª¨ë‘ ì†Œì§„ë˜ì–´ ì¹´ì§€ë…¸ì—ì„œ í‡´ì¥í•©ë‹ˆë‹¤...\n");
            usleep(1000000);
            break;
        }

        printf("\033[H\033[J");
        printf("\n------------ ğŸ° ìŠ¬ë¡¯ë¨¸ì‹  ê²Œì„ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! --------------\n");
        printf("\n");
        printf("í˜„ì¬ ê³¨ë“œ: %dG\n", *gold);
        printf("ëˆ„ì  ë‹¹ì²¨ê¸ˆ : %dG\n", reward);
        printf("\n------------------------------------------------------------------\n");
        printf("ë°°íŒ… ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš” (ìˆ«ì ì…ë ¥ í›„ Enter): ");
        fflush(stdout);

        char buffer[10] = {0};
        int index = 0;

        while (1) {
            ch = getch();
            if (ch == '\n' || ch == '\r' || ch == 13) break;
            if (ch >= '0' && ch <= '9' && index < 9) {
                buffer[index++] = ch;
                putchar(ch);
                fflush(stdout);
            } else if ((ch == 127 || ch == 8) && index > 0) {
                index--;
                buffer[index] = '\0';
                printf("\b \b");
                fflush(stdout);
            }
        }
        buffer[index] = '\0';
        printf("\n");

        bet = atoi(buffer);
        if (bet <= 0) {
            printf("â— 0 ì´í•˜ì˜ ê¸ˆì•¡ì€ ë°°íŒ…í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!\n");
            usleep(1000000);
            continue;
        }
        if (bet > *gold) {
            printf("\nâ— ë³´ìœ  ê³¨ë“œë¥¼ ì´ˆê³¼í•œ ê¸ˆì•¡ì…ë‹ˆë‹¤!\n");
            usleep(1000000);
            continue;
        }

        *gold -= bet;
        srand(time(NULL));
        num[0] = rand() % 9 + 1;
        num[1] = rand() % 9 + 1;
        num[2] = rand() % 9 + 1;

        printf("\nğŸ° ê²°ê³¼: [ %d ] [ %d ] [ %d ]\n", num[0], num[1], num[2]);

        if (num[0] == 7 && num[1] == 7 && num[2] == 7) {
            int prize = bet * 777;
            reward += prize;
            *gold += bet;
            printf("ğŸ‰ JACKPOT! 1ë“± ë‹¹ì²¨! 777ë°° ëˆ„ì ! (ì´ë²ˆ ë‹¹ì²¨ê¸ˆ: %dG)\n", prize);
        } else if (num[0] == num[1] && num[1] == num[2]) {
            int prize = bet * 5;
            reward += prize;
            *gold += bet;
            printf("âœ¨ 2ë“±! 5ë°° ëˆ„ì ! (ì´ë²ˆ ë‹¹ì²¨ê¸ˆ: %dG)\n", prize);
        } else if (num[0] == num[1] || num[0] == num[2] || num[1] == num[2]) {
            int prize = bet * 2;
            reward += prize;
            *gold += bet;
            printf("ğŸ‘ 3ë“±! 2ë°° ëˆ„ì ! (ì´ë²ˆ ë‹¹ì²¨ê¸ˆ: %dG)\n", prize);
        } else {
            int loss = (*gold > 10) ? (*gold / 10) : 1;
            *gold -= loss;
            printf("ğŸ’” ê½ì…ë‹ˆë‹¤. ê³¨ë“œì˜ 10%%(%dG) ì¶”ê°€ ì°¨ê°ë©ë‹ˆë‹¤.\n", loss);
        }

        printf("í˜„ì¬ ê³¨ë“œ: %dG | ëˆ„ì  ë‹¹ì²¨ê¸ˆ: %dG\n", *gold, reward);
        printf("-----------------------------------------------------\n\n");
        printf("ğŸ° ì¬ì‹œì‘ : 1 / ì¢…ë£Œ : 0 \n");
        printf(">> ");
        fflush(stdout);

        char again_ch;
        while (1) {
            again_ch = getch();
            if (again_ch == '0') {
                printf("\nì¹´ì§€ë…¸ë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤...\n");
                if (reward > 0) {
                    printf("ğŸ ëˆ„ì  ë‹¹ì²¨ê¸ˆ %dGë¥¼ ì§€ê¸‰í•©ë‹ˆë‹¤!\n", reward);
                    *gold += reward;
                    reward = 0;
                }
                usleep(1000000);
                return;
            } else if (again_ch == '1') {
                break;
            } else {
                printf("\nâ— ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. 0 ë˜ëŠ” 1 ë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n");
                printf(">> ");
                fflush(stdout);
            }
        }
    }

    if (reward > 0) {
        printf("\nğŸ ëˆ„ì  ë‹¹ì²¨ê¸ˆ %dGë¥¼ ì§€ê¸‰í•©ë‹ˆë‹¤!\n", reward);
        *gold += reward;
    }
    printf("ê²Œì„ ì¢…ë£Œ í›„ ì´ ê³¨ë“œ: %dG\n", *gold);
    usleep(1000000);
}

void resetGame(int *playerX, int *playerY, int *playerHP, int *playerMaxHP, char **currentMapName, char map[ROW][COL], char map_backup[ROW][COL]) {
    *playerX = 1;
    *playerY = 18;
    *playerHP = 100;
    *currentMapName = "ë§ˆì„";
    memcpy(map, map_backup, sizeof(char) * ROW * COL);
    monsterCount = 0;
    for (int i = 0; i < MAX_FIREBALLS; i++) {
        fireballs[i].active = 0;
    }
}

// ì¶œë ¥ ì‚¬ì´ì˜ ëŒ€ê¸° ì‹œê°„ (ì´ˆ)
#define STORY_DELAY 2

// =================================================================
// ==================== ASCII Art ì‚½í™” ë°ì´í„° =======================
// =================================================================
const char* dragonBoss[] = {

"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡…â €â €â €â¢€â¡‡â €â €â¢€â „â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢ â ƒâ¢€â „â¢€â£¼â ƒâ¡°â¢€â¡â¡ â â €â¡ â „â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â „â €â ‚â â¢ â¢â¡¤â¡šâ£°â£¿â¢â£¼â¡·â£¿â¢‹â£ â –â¢‰â €â¡€â „â ‚â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡€â¢ˆâ €â ‚â¢„â¢â¡¸â¢ â¡¿â£®â¢®â£¾â£¿â¢¿â£Ÿâ£½â£Ÿâ£·â£Ÿâ£¡â£¶â¡µâ¢Šâ£â ¤â ”â ‚â ‰â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â „â  â¢€â Œâ ¢â ¢â£°â¢¯â£Ÿâ£—â£¯â¡¿â¡«â¡»â¢®â¡¯â£¾â£½â£¯â¢¿â¡¿â£¯â£¾â£â£â¢„â €â¡€â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â¡€â¢¨â£¾â£»â ¶â£¦â¢µâ£Ÿâ¢³â¢¯â¡»â¡­â£»â£â£¯â¢¾â£Ÿâ£¿â£»â£³â£½â£â¢¿â£½â£Ÿâ£¿â£®â –â ¦â ¢â ¤â¡ â¡€â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â¡€â£€â  â €â „â ¸â «â¡¹â¡«â¢â¢¿â¢â£·â£µâ£Ÿâ¢®â â¡®â¢®â¡»â£â£§â£¿â£µâ£·â£â¡¿â£®â¢¯â¡·â£¿â¢¿â£·â£¦â£„â¡‚â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â¢°â ‰â €â¡‰â ‰â šâ ¢â ¦â£„â ¹â£Œâ£³â£±â£¼â¢â£â£ºâ¡¯â¡»â¢µâ¡¿â£½â¢­â¡â¡¶â¢§â£â£â¡â£¿â£½â£»â£Ÿâ£¿â£»â¡Ÿâ¢¿â¡“â ¢â €â €â €â €",
"â €â €â €â €â €â €â €â €â ³â¢„â¢€â ˆâ  â â¢¢â¡´â£¾â¢¾â ½â¡­â ›â¢»â£¿â£³â¢¯â£â£—â£¿â£»â¢®â£â£â¡³â£â¢®â¡¿â£â£·â¢¿â£½â¡¿â£¿â£¿â¡¦â£â ¢â¡„â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â¡€â â  â â €â »â¡â â €â €â €â €â £â¢»â¡™â¢¯â£¯â¡Šâ »â£¦â¡¹â¡šâ¢¬â ‘â ¯â£šâ¢Ÿâ£¿â£»â£Ÿâ£¿â£¿â£¯â£¿â¡¢â¡‘â ˆâ â €â ˆ",
"â €â €â €â €â €â €â €â €â €â €â €â €â ‚â €â â €â €â €â €â ‚â  â¢€â €â¡€â ‘â „â¢€â ™â £â „â¡™â¢†â €â  â €â  â¡ˆâ£·â¢¿â¡¿â£¯â£¿â£Ÿâ£¿â£·â¡Œâ €â €â ‚â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡â£ â£¢â£¾â£´â£·â£®â£–â£‚â£ â£„â¡ â €â „â¢€â €â¡â¢€â €â¢²â£®â£¿â¢½â£¿â£¿â¡¿â£¿â£›â¢¯â »â£†â Œâ ‚â €",
"â €â €â €â €â €â €â €â €â €â €â €â ˆâ €â €â ˆâ£´â¢¿â¡¿â£¿â£¿â¢¿â£¿â£»â¡¿â£¿â£¿â£·â£¶â£µâ¡¤â ”â£ â£´â£´â£Ÿâ£¿â£³â£¿â¢½â£¿â£¾â Ÿâ£¯â¢£â ˆâ¢§â ™â¢„â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£¼â£¿â£»â¢¿â ¯â »â ›â —â ¿â ½â£·â£³â£¯â£¾â£â¡¿â£¿â¢Ÿâ¡·â£»â¢®â£·â£¿â¢¯â£¿â¢¿â¡Ÿâ €â¡·â¡´â ƒâ €â â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â£¸â£¿â£¿â£»â¡·â£„â¡°â£ â£©â¡µâ£³â¢½â¡³â£·â£«â£â¢½â¡â£¯â£»â¡½â£»â£·â£¿â¡³â¡¿â¡‘â €â â ‡â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¸â£¿â£¿â¡½â£¯â£¯â£«â¢·â¢µâ¡½â£¾â¡«â¡»â£µâ£·â£»â£½â£¿â£¿â£ªâ£¿â£»â¢·â¢â£¿â£·â£·â£„â €â €â â â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ™â¢¿â£½â¡·â£·â£»â£—â£¿â£ºâ£·â£›â£¿â£»â£â£¯â¡·â£¯â¡¿â£ºâ¡§â£«â£—â£¿â¢¿â£¾â£»â£â£´â£„â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ‰â¡™â Ÿâ¢¿â¡¿â£½â£¿â£ºâ¢·â¡¯â£¿â¡½â ‰â ›â¡½â ¸â£¯â£¿â¡½â£¾â¡â¢»â£½â¢·â£½â£Ÿâ£¿â£¿â¡€â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â €â ˆâ  â šâ£¡â¡¿â£½â¡¿â£¯â¢¿â£½â ›â šâ£€â¢ â£€â£¬â£¿â£â£¿â£½â¡§â €â¢»â£·â¡¿â¢½â¡‹â¢»â£§â €â €â €â €â €",
"â €â €â €â €â €â¢€â €â €â €â €â €â£€â£€â£±â£¢â£¿â£¿â£¶â£¾â£µâ£¿â£¿â£»â¡¿â£¿â£­â£Ÿâ£·â£¯â£¿â£»â¡¾â£·â¢¿â£Ÿâ£¿â ‡â €â£½â£‡â£´â ‚â ‹â¡¸â ƒâ €â €â €â €â €",
"â €â €â ¢â  â£„â €â ‰â¢¦â¡€â¢¸â£ºâ£¶â£¿â£¿â£Ÿâ£¿â£½â¢¯â¡¿â£¿â£½â£Ÿâ£¿â£»â¡¿â£¾â¡½â£—â¡¿â£¾â£½â£»â£Ÿâ£¿â£»â â €â  â ˆâ ‰â €â €â  â €â €â¢€â €â €â €â €",
"â£ˆâ â “â ¶â£¤â£™â£³â£¦â£¿â¡¿â£Ÿâ£¿â¡ºâ£¾â£â£¿â¢¾â£Ÿâ£¿â£³â£¿â£½â¢·â£Ÿâ£¿â£â£¿â¡½â£¿â¢¾â£¯â¡¿â ½â â â €â €â €â €â ‚â €â €â €â €â €â ‚â €â €â €â €",
"â ‰â ™â ³â ¶â£¶â£½â£¿â¢¾â£·â¢¯â¡¿â£â£¿â£»â£¾â¡½â£¯â ‹â¢â£‰â£¨â£â£¯â¡»â£¾â£½â¡â ‰â ‰â ‰â â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â  â¡ â¢¬â¢¿â£¿â£¿â£»â£Ÿâ£½â¡¿â£¯â£¿â£¿â£¿â£¿â£Ÿâ¡¿â£»â£¯â¡¿â£ºâ¢¾â£—â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â£°â£¿â£¯â£¿â£»â¡¿â â ›â â â ™â šâ ›â¡¾â£·â¡¸â£¿â¡â¢â£¿â¢¿â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â â¢â£·â¢¿â£®â¢¿â£§â €â €â €â €â €â €â ˆâ €â ™â €â ƒâ €â €â ˆâ »â¢¿â£·â£¤â£€â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â¡â¢¹â£Ÿâ£¾â¢¯â£¿â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â¢ â¡¿â ›â£¿â£¿â£§â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â »â£Ÿâ£¯â£¿â£»â£·â£¦â£¤â£¶â£Ÿâ£¶â£·â£µâ£¶â¡·â£¶â£¥â£¤â£€â£›â ¾â£¿â¡¾â£¿â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â ˆâ ¹â¡â ¿â£½â¢¿â£¿â£»â£¿â£½â£·â£¿â£½â£¿â£»â£Ÿâ£¿â£¿â£¿â£¿â£¯â¡½â ƒâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â ‰â ¢â£„â¡ˆâ €â ˆâ ‘â Œâ ™â ’â ¤â €â €â €â €â €â €â €â €â ‰â šâ¢¿â£¿â£·â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â ™â ¿â£¶â£¤â£„â£ˆâ£’â£¤â¡ˆâ¢¢â¡„â €â¢„â €â €â €â €â €â ˆâ£¿â£¿â¡â¢„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ ™â »â£¯â¡¿â£½â£»â¢·â¢¿â£·â£¤â£³â£”â£¤â£¢â£„â£¶â£¿â£¿â ƒâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â  â£€â£„â£¿â£¿â¢·â£Ÿâ¡¿â£¾â£½â£«â£¯â¢¿â£½â£Ÿâ£¿â£½â ‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¢€â£„â£¨â£·â£¿â£»â£Ÿâ£·â¢¿â£â£·â£¿â£³â£Ÿâ£¿â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ¤â ’â¢‹â¡­â â£»â¡¯â ·â¢›â â¡¼â ‘â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ â €â ˜â ˆâ €â €â â €â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â € ",

};

const char* dragonFight[] = {
"â €â €â ˆâ „â¡â ‚â €â ˆâ „â ¡â¢ˆâ €â €â ¡â¢ˆâ â €â €â ˆâ „â¡â ‚â €â €â ¡â¢ˆâ â €â €â ¡â¢ˆâ â €â €â ˆâ „â¡â ‚â €â €â ¡â¢ˆâ â €â €â ¡â¢ˆâ â €â €â ˆâ „â¡â ‚â €â €â ¡",
"â¡â  â¢ˆâ â €â¡â ‚â Œâ¡€â â¢‚â â  â â ‚â ˆâ¡â  â¢ˆâ â €â¡â ‚â „â¡â ‚â¢ˆâ â  â â ‚â ˆâ¡â  â¢ˆâ â €â¢â ‚â „â¡â ‚â¢ˆâ â  â â ‚â ˆâ¡â  â¢ˆâ â €â¢â ‚â „â¡",
"â „â â¢‚â €â¡€â „â â ‚â „â¡€â  â ˆâ „â¡â¢€â €â „â â¢‚â €â¡€â „â â ‚â „â£€â ‚â Œâ  â¢â €â¡€â „â â¢‚â €â¡€â  â ˆâ â¡€â¢€â  â ˆâ „â¡â¢€â €â „â â¢‚â €â¡€â  â ˆâ ”â¡€",
"â €â €â¢€â ‚â¡â €â €â¢ˆâ â  â¢â €â €â¡â  â¢ˆâ €â €â¢€â ‚â¡â €â €â  â ˆâ „â¡ˆâ €â €â¢‚â â  â €â €â¢€â ‚â „â¡â €â €â¡â¢€â ‚â €â €â¡â  â¢ˆâ €â €â¢€â ‚â ¤â¢â ‚â €â¡",
"â Œâ¡â  â €â €â ¡â ˆâ „â¡ˆâ¢ â ¤â£Œâ£â£€â â €â Œâ¡â  â €â €â ¡â ˆâ „â¡â €â  â â Œâ¡€â ˆâ €â ¡â¢ˆâ£„â£ˆâ£¤â£´â£§â£¶â£¶â£¶â£¼â£¤â£¥â£¤â£¥â£¤â£¬â£´â£ â£ˆâ£„â  â¢ˆâ â¡€",
"â ‚â €â¢â ‚â „â¡â ˆâ â£€â£‚â£”â£ â£´â£¼â£¿â£¿â£¶â£¦â£¥â£‚â¡„â â ˆâ â¡€â ‚â „â â ‚â£â£¤â£¶â£¿â£Ÿâ£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â Ÿâ ‹â â¡‰â €â ‚â „â „",
"â¢€â €â  â£Œâ£¶â£¶â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ¿â ¿â ·â ¶â£¤â£¡â¡ˆâ¢€â ˜â¡‰â „â  â¢â ‰â¡™â »â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â£¯â£¿â£¦â£â ‚â „â¡€â €â Œ",
"â ‚â Œâ¡â¢©â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ¿â ›â Ÿâ §â£„â ‚â „â ¡â €â €â ™â¡†â â¡€â €â£„â¢†â¡°â£€â °â¡‰â Œâ ¹â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡½â¢¯â¡Ÿâ£¿â£¿â£¿â£¶â£¤â¢€â â ‚",
"â â €â â£´â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â ‹â „â ˆâ €â¢ˆâ â¡€â£â ˆâ¡„â ¡â¢ˆâ â €â â „â¡â šâ §â£³â¢¥â¡“â¢¤â ˆâ €â¡ˆâ »â£¿â£¿â£¿â£¿â£¿â£¿â£·â¡¹â¢§â£¿â â ‚â Œâ €â ˆâ¡",
"â¢‚â â¡ˆâ£‰â£¹â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢¿â¡â Œâ â¡€â¢†â£´â£®â£´â£¿â£²â¡„â£ƒâ „â¢ˆâ â¡€â ‚â „â â¢‚â¢¸â¢£â£»â¢†â¡¹â „â „â ¡â ™â£¿â£¿â£¿â¡·â£â ¿â£¿â£Ÿâ£¾â¡„â â¢¢â â  â €",
"â „â¢‚â â£»â¢›â¡™â¢»â¡½â£â ·â£¿â£¿â£¿â¡€â¢€â ¢â£½â£¿â£¿â£¿â£¿â£¿â£¿â¡½â£†â¡†â¢€â ‚â „â¡â¢€â¢°â¢¸â£¡â£¾â£·â£¾â£¿â£»â£¬â â¡€â£¿â£¿â£¿â¡¿â£­â ³â£â¢¿â£¿â£¿â£â¢§â ˆâ „â¡",
"â €â €â €â¡Ÿâ¡¼â¢°â œâ¢³â£â¢³â¡¹â£¿â£¿â£·â£„â¢šâ£¿â£¿â£¿â¡Ÿâ¡‰â »â£¿â£¿â£¿â£§â €â €â €â¡â¢€â£¾â£»â£¼â£¿â£¿â¢¿â£¿â£¿â£¿â£§â£¼â£¿â£¿â£¿â¢Ÿâ¡²â¡¹â£Œâ¢¿â¡½â¡â¢¯â¢³â €â €â¡",
"â Œâ  â â£¿â£•â¢£â â¡±â£Šâ¢§â ³â£œâ¡¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£„â ¡â ˜â ¿â¡â¡™â ·â¢ˆâ â  â£¼â ¾â£¿â£¿â ‰â „â£¨â ¿â£¿â£¿â£¿â£¿â£¿â£¿â£â¡®â£•â ³â ™â ¾â£·â ¨â£‡â¢§â ˆâ¡â €",
"â Œâ  â â£¾â¢¯â¢§â¡›â¢´â¡©â¢†â ³â£€â¢‹â£¥â£¿â£¿â£¿â£¿â£¿â£»â£‡â¢‚â ¡â¡˜â ƒâ Œâ ‚â¢†â¡ˆâ „â¡â ‚â¢¿â €â Œâ °â£½â£¼â£¶â£¿â£¿â£¿â£¿â£¿â£Ÿâ£«â¢†â ¡â¡™â¡œâ£©â “â£Œâ£§â â  â¢",
"â¡€â¢€â â£Œâ¡Ÿâ¢§â£»â¢¦â¡±â£ˆâ “â¢¶â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â£¿â£¾â  â¢ˆâ¡â¡ˆâ¡ˆâ¡„â¡ˆâ €â¡„â¢â¢¢â »â¢›â ³â£¯â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â¡â ”â¡±â¡˜â¢¤â¢«â£Ÿâ¡¾â¢€â €â ‚",
"â¡â¢€â ‚â¡½â¢¾â¡¹â£Œâ¢·â£»â¢´â¡©â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ¿â£·â£â£»â£·â Ÿâ¡»â ¥â£‰â ´â¢¡â Šâ£´â ¥â£‚â ³â£¼â Ÿâ »â ›â¡›â¢‹â¢»â£¿â£¿â£¿â£¿â£¿â£¿â ¥â¡±â£‰â¡¾â¢â¢›â¡»â €â Œâ¡€",
"â â €â ‚â£¿â£Œâ¡›â¡œâ¢¶â¡¹â¢¾â¡½â£¿â£¿â£¿â£¿â£¿â£¿â¡›â¢¦â¢©â ™â¢·â£¦â¡¸â£”â£¡â¢†â¡ƒâ¡ˆâ£¾â¢‰â ²â ¼â¡Ÿâ¡‡â Œâ£¡â¢¢â£µâ£®â£·â£¿â£¿â£¿â£¿â£¿â£¿â£—â¡ˆâ ¯â¢›â¢¤â££â¢Ÿâ €â¢‚â ",
"â  â¢€â â£®â£Ÿâ ¿â£¼â£®â¡±â£§â¡â¢¿â£¿â£¿â£¿â£Ÿâ¢¹â£¿â£¦â¢§â£™â¢†â¡›â¢³â ¦â£˜â¢³â£Œâ¡ˆâ¡²â£§â¢Šâ ”â£¡â¢˜â£´â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£Ÿâ¡‡â£®â£½â£¢â£Ÿâ¡¾â¢€â ‚â Œ",
"â¡â ‚â Œâ£¿â£¿â£¿â¡´â£¯â¡•â££â¡â¡â¢¿â£¿â£¿â£¿â£¦â¡»â£œâ §â£â ®â£â¢£â â£Œâ£¿â¡§â¡ˆâ ¿â£»â¢·â£¾â£¶â ¿â£›â£­â£¶â¡¾â¢Ÿâ¢›â »â£©â£¿â£¿â£¿â¡¿â£â¡ˆâ¢­â¡™â£·â¢Ÿâ¡¿â €â Œâ¡€",
"â €â €â¢ˆâ£¿â£¿â£¿â£Ÿâ¡·â¢³â¡œâ¡»â¢¶â¡â£Ÿâ ¿â£¿â£¿â£¿â£¶â£¯â£¬â£³â£¬â£§â£¾â£¿â¡Ÿâ¡°â¡ˆâ ³â¡˜â¡’â¢†â¢â¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡˜â¢†â£©â£¶â£¿â£¿â£¿â¡›â¡ˆâ£´â¢¢â¡â£½â£â£¯â¡¶â â €â¡",
"â¢‚â â  â ­â¡»â¢¿â£¿â£¿â£·â£­â¡Ÿâ£®â¢·â¡â¡â£¬â£½â£›â ¿â¡¿â¢¿â ¿â¡¿â¢Ÿâ¡»â¢‰â¡¬â£‘â¢£â¡ˆâ¡ˆâ¡ˆâ¡ˆâ£Œâ¡ˆâ¡ˆâ££â£¶â£½â ¾â¢¿â¡›â¢‰â¡ˆâ¡ˆâ¡ˆâ¡¿â£¬â¢·â£¿â¡Ÿâ ¿â â¢‚â â ‚â „",
"â ‚â Œâ â¡€â â ¬â¢¼â£»â£¿â¢·â£¿â£µâ£¦â£â£»â¡â¡â¡â¡â¡â¡†â£™â¡â¢£â£â¡ˆâ¡ˆâ¡ˆâ¡ˆâ£‡â¡ˆâ¡ˆâ£™â¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ£¦â£½â «â¡â£·â£½â£¿â£›â£ â¢€â  â €â Œâ â¡€",
"â €â €â â  â ‰â „â €â  â ™â¢‹â ›â ³â£¿â£¼â£œâ£¯â¢¶â£½â£¹â£‹â£¶â£¥â¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ¡ˆâ£‹â¢¶â£â£¿â£¿â£½â£¶â¢®â£­â£¶â£¿â£¶â¡™â¢ƒâ¡€â¢â ˆâ¡â¢‚â â €â €â¡",
"â Œâ  â¢â €â â Œâ¡€â¢ƒâ ¹â¢†â â¡°â â¢‚â ‹â¢½â£©â¡‰â Ÿâ£¿â£¿â£·â£¿â£¾â£â£¯â£´â£â¡¶â£»â¢¿â£Ÿâ£¯â£¿â¡¿â ¿â¢šâ â ¹â£‡â ˆâ ¡â ’â¡€â¢Šâ â ‰â â Œâ¡€â¢‚â €â €â ˆâ „â ¡â €",
"â ˆâ â  â €â „â ‚â â¢€â ‚â Œâ  â ‘â ˆâ „â  â¢€â €â ‰â ›â¡„â¢‰â ›â ›â ‰â „â¢²â¡¹â »â£¿â£â¡šâ šâ¢‰â ™â ¢â Œâ  â ˆâ ‹â¡â Šâ „â¡â €â ‚â „â  â¢€â ‚â â  â €â „â¡ˆâ €â â¢‚",
"â¡€â¢€â  â â Œâ¡€â¢€â  â ˆâ „â ¡â¢ˆâ €â Œâ¡â  â¢€â €â¡â¢ˆâ ’â¡‰â ’â¡ˆâ ˜â ¡â â¡€â¢ˆâ ‘â ¢â¢â ˆâ¡â â¡ˆâ „â¡â¢‚â €â¡â¢‚â â¡€â €â Œâ¡â  â¢€â €â  â¢â ‚â „â¡€â¢€â ‚",
"â â¡€â¢‚â €â €â¡â¢€â ‚â¡â €â â  â ˆâ „â €â €â¢‚â â  â €â €â „â ¡â¢€â â €â â¡€â ‚â „â €â €â ‚â „â ¡â €â €â â¡€â ‚â „â €â â  â¢â ‚â €â €â ‚â Œâ¡â €â €â â¡€â ‚â „",
"â â €â  â¢ˆâ â¡€â €â â  â â Œâ €â â Œâ  â¢â €â¢ˆâ  â â Œâ¡€â â €â Œâ  â¢â €â â Œâ  â¢â ˆâ €â ¡â ˆâ „â¡â €â â Œâ  â¢â €â €â Œâ  â¢â ˆâ €â  â â Œâ¡€â €â â¢‚",
"â  â¢€â â €â ‚â „â  â ˆâ „â ¡â ˆâ „â  â ˆâ â  â €â „â¢‚â â ‚â „â  â â¡ˆâ â  â €â „â¡ˆâ â  â €â „â  â â ‚â „â  â €â Œâ â  â €â „â¡ˆâ â  â €â „â  â â ‚â „â  â¢€â ‚"
};

const char* dragon[] ={
"â£¿â£¿â£¿â£¿â£¿â£¿â£¶â£¤â¡€â¡€â €â €â €â €â ™â »â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢»â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â¢Ÿâ ¿â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¶â£…â¡‚â¡€â â ˆâ¢€â ˆâ ›â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â¢¸â ¹â£¿â£¿â£¿â£¿â£¾â£¦â£‡â ¢â €â „â â ˆâ ‰â ™â ›â ¿â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â£¦â¢¡â¡ â €â €â ‚â¢€â ™â¢¿â£¿â£¿â£¿â£¿â£¿â£§â¡‘â Œâ¡™â ¿â£¿â£¿â£¿â£¿â£·â¡¡â €â¡â ˆâ „â â¡€â ‚â¢€â ˆâ¢‰â ™â »â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£§â£·â¡†â¡â €â¢€â €â „â ™â¢¿â£¿â£¿â£¿â£¿â£§â ¡â  â €â ™â¢¿â£¿â£¿â£¿â£¿â£†â â  â €â â „â¡â €â  â €â¡€â ‚â €â¡€â ™â »â ¿â£¿â£¿â£¿â£¿â£¿â£¿",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡Œâ ¢â¡€â¡€â €â¢€â €â ‰â ¿â£¿â£¿â£¿â£§â¢‘â¢ˆâ  â €â ™â¢¿â£¿â£¿â£¿â¡Œâ¡‚â¡‚â „â €â €â …â¡‚â  â €â â¢€â €â  â €â €â ˆâ ›â¢¿â£¿â£¿â£¿",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â¡â ¢â â¡ˆâ €â €â €â „â ˆâ »â£¿â£¿â£‡â ¢â €â¢‚â  â €â ™â¢»â£¿â£¿â¡°â¢â â ˆâ €â €â¢€â ¡â ‚â â €â â €â „â ˆâ €â¡€â ‚â ™â¢¿â£¿",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£§â ¡â ¡â â¡ˆâ¢€â ‚â¢€â €â¢€â ˆâ¢»â£¿â¡…â …â „â¢€â €â „â €â ™â¢¿â¡®â¡‚â Œâ Œâ¡€â â €â €â ˆâ ¨â¡€â â €â ‚â ˆâ¢€â €â €â ˆâ €â ™",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â „â …â ‚â¡‚â …â Œâ „â¢€â „â €â €â ˆâ¢‡â •â  â €â¡€â €â „â €â €â¢•â¢â â¡‚â „â¢â â €â â €â¡€â¢‘â ˆâ €â ˆâ €â €â „â â ˆâ €",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡‡â ¡â ¡â¡‚â …â …â Œâ¢‚â €â ‚â¡â €â¡¢â¢‘â â „â €â €â „â €â¢ â¢ƒâ ‚â¡‚â¢â €â ‚â  â €â „â ‚â €â €â ¨â â €â ‚â €â €â „â €â „",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢¿â£¿â¢¿â ¯â¡¸â ˆâ¢”â ¨â  â ‘â €â …â â¢€â €â¡€â €â ˆâ €â¢ˆâ¢€â  â ¨â ‚â¡€â¡‚â¡â  â¢€â ¡â â €â¢€â €â €â  â €â ˆâ¢‚â „â ˆâ €â¢€â  ",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢¿â£¯â »â¢‡â «â¡¸â ¨â  â¡‘â¢â ¨â¢€â ¡â ˆâ¢€â  â ˆâ €â €â¡€â ¨â¢â ¨â¢€â â â¡ˆâ „â ‚â  â €â ‚â¡€â €â  â €â €â €â¢€â €â €â  â â €â ‚â¡â¢€â €",
"â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢¿â¡Ÿâ ½â¡‰â¢‘â ˆâ  â¡â¡•â¡â ¢â¡±â €â¢‚â â¡€â „â ˆâ¢€â  â ˆâ¡â¢€â ¡â¢€â â¢€â ¨â €â „â â ˆâ €â â €â €â €â „â €â ˆâ €â €â €â €â €â €â¡€â ˆâ „â¡€â €â „",
"â£¿â£¿â£¿â£¿â£¿â£¿â¢¿â¡‰â £â  â â „â ‚â Œâ¡Šâ¡¢â¡‘â¡€â …â¡‡â €â ‚â¢‚â â¡ˆâ  â €â¡€â ‚â¢€â  â €â €â „â €â¡€â „â €â „â €â „â €â  â â €â €â  â €â¢‚â  â¡ˆâ¢„â¢â €â €â¡€â â  â €â €",
"â£¿â£¿â£¿â£¿â¡¿â¡â¢’â  â ¡â¢â ˆâ  â ˆâ£‚â â¢â¢â €â¢‚â …â¢€â €â ‚â €â¢„â ‡â €â¢€â €â €â €â €â €â¡€â €â €â €â €â „â €â „â¢€â €â €â  â¡‘â¡…â¡£â¡±â¡°â£Œâ¢¢â ¢â¡¡â¡â¡‚â¡‚â¡â ¡â €",
"â£¿â£¿â¡¿â¡£â ƒâ ‚â¢„â …â¢‚â Œâ¡Œâ ”â¢ˆâ ¦â¡ˆâ¢â  â â¡ˆâ €â €â €â¢ˆâ¢¢â …â €â €â €â¡€â ‚â €â â €â €â â  â €â¢€â €â ‚â¢€â  â €â â¡ˆâ¡Šâ¡ºâ¡¸â£ªâ¢ªâ¡ªâ£ªâ¢ªâ¢¢â¢¢â ¡â¡‚â¡¡â â €",
"â£¿â£¿â¡¿â¡â¢‚â ¡â â …â¢”â ¡â Šâ¡€â ‚â¢€â ‘â ¹â¡â¡€â¢€â ‚â â €â¢”â¢€â Šâ €â €â ‚â â €â €â ˆâ €â ˆâ¡€â¢ˆâ €â €â €â  â â €â €â „â €â €â Šâ Œâ œâ¡Œâ£‡â ¯â£ªâ¡ºâ¡¢â¡±â¡±â¡â¡â¡",
"â¡¿â¡›â  â¢â¢„â ¢â¢‘â ‰â „â ‚â €â¡€â  â €â €â¢…â ¨â£‚â  â €â¢â ¨â ˆâ €â¢€â €â ‚â¢€â â €â €â  â €â¢â¢®â¡²â¡…â¢…â ‚â €â  â €â¢â €â¡â €â „â â ¡â ¸â¡˜â¢â¡²â£•â¡‡â£â¢®â¢Šâ¢†â …",
"â ƒâ¡°â ¡â ¡â â¢ˆâ €â „â£°â£´â¢¤â¡ â¢€â â €â¡ˆâ ”â â „â Œâ¢€â ƒâ â¡ˆâ €â €â¢€â â¡€â â €â €â €â ¢â¡©â¢£â £â¡‘â ¨â â €â ˆâ¡€â¢€â â €â €â â ˆâ ¢â¡€â „â¡«â¢®â¡ºâ¡¸â¡œâ¡â¡†â¡£",
"â¡ƒâ¡‚â¢â¢ˆâ¢°â¡€â¡‚â£½â£¿â£¿â£Ÿâ¡¯â£‡â „â£‚â£„â¡˜â¡€â …â …â¡‚â €â ‚â €â €â €â  â â €â ˆâ €â¡€â ‚â ˆâ „â …â ¢â ¨â  â¢â â €â €â¡€â¢‚â â „â €â €â ‚â¢¡â¢â¢â£•â£â£—â¡â¡â¡ªâ ¢",
"â¢‡â ‚â¡â¡”â¡…â¡‡â£‡â¢·â£»â¡½â£¯â¡»â¡œâ¡â£¿â£¿â£½â£¢â  â ‘â „â „â¡€â£‚â¢¢â¢‚â¡¢â  â¡€â ‚â €â¡€â¢€â €â â ˆâ „â¢â â €â¢€â â €â â¡€â ‚â „â¢â â  â¢Šâ¢Œâ¡¼â¡ºâ£œâ£–â¢£â £â £â¡¡",
"â£â¢Œâ¢â¢œâ¢œâ¢µâ¢±â¡¹â£ºâ¢â¢µâ¢¹â¢¸â ªâ¡³â£»â£ºâ¢ªâ¡£â …â ‚â¡œâ£œâ¢œâ¢®â ·â¡¯â¡£â ¢â ¡â¢€â â¢€â Šâ €â â ˆâ €â €â €â ‚â¡€â¡¢â£µâ£—â¢â¢Œâ¢„â¢â¢¥â¢â¡®â¡¯â£«â¢ºâ”¥â‡‡â £â¡±â¡˜",
"â¡¨â Šâ¢œâ ˜â œâ ®â¢®â¢ºâ¡ªâ£§â¡£â¡£â¢£â¡±â¡œâ¡œâ£œâ¢œâ¡¼â£¬â£¨â¢Šâ£†â£‡â£‡â¢•â¢…â Šâ œâ¢ˆâ  â â¡€â ¤â Œâ¢„â „â¢‚â¢€â¢„â ¡â¢„â â¡®â ªâ¡ªâ£”â£•â¡§â¡¯â£›â ®â¡‹â¡œâ¡Œâ¢â ¢â¡ƒâ¡ƒâ ”",
"â …â Œâ¢„â â¢œâ¢Œâ¢†â¢‡â •â¢•â §â¡«â¡³â¡¹â¡½â£•â¢¾â£â¢¿â¢½â£â¡³â¡¹â¡â¡â¡•â¡•â¢•â ¡â¡ â¡¸â¡³â£”â£”â£”â¢„â£„â¢¦â£²â£³â£ªâ¡²â£¼â¡ºâ£â¢â¢—â¡“â¡â¡â¡â¡‡â¡‡â¡£â¡£â ƒâ •â¢â  â¢",
"â Œâ¢Œâ ¢â¢˜â â¢•â¢•â¢•â â¢â¢â¢â¢â¢ºâ¢¸â¢¸â¢œâ¢â¢¯â¢®â¢®â£ºâ¢œâ¡ªâ¡¢â£•â£œâ¢¼â¡ªâ£–â¡¯â¡—â¡—â£—â¢â¢—â¢½â¢³â¢µâ££â£³â¢¹â¢œâ¢â¢â¢‡â¡‡â¡•â¡•â¡â¢˜â Œâ¡â¡¢â ‚â …â¡¡â¢‚â¢Šâ¢€",
"â  â¡¡â ¨â¡ â¢‘â¢â¢â¢ˆâ Šâ¡¢â¡‘â¢…â¢‡â¢‡â¡ƒâ¡‡â¡‡â¢§â¢£â¡£â¡£â¡‹â¡—â¡â¡â¡â£â¢§â¡«â¡®â¢®â¡«â¡â¡â¡§â¡«â¡‘â¢•â¢‘â¢’â£‚â¢‡â¢¥â¢³â ±â¡±â¢¨â¢Šâ Šâ¡”â¡±â¡˜â ˆâ¡€â¡Œâ Œâ ”â â¡‚â ",
"â â ‚â¡â¡â  â ‘â¡â¢„â ¨â  â ˆâ¢†â¢Šâ ¢â¡ƒâ¢‡â¢”â¢…â ¥â¢±â¢±â ‘â¢•â¢±â ¨â¡Œâ¡Œâ œâ¢Œâ ªâ¡¢â£‚â¢£â ±â ‘â Œâ¡â¡¢â¡ªâ¡±â¡â …â £â¢¡â¡â¢Œâ¢ â¢â ªâ¢ˆâ ‚â ¢â¢‘â ‘â ¨â €â …â ‚â ”â ˆ",
"â €â ¡â â €â ¡â¢‚â ¨â¢€â â ¨â¢ˆâ  â¢‚â ‘â¡‘â „â¢…â £â¡¡â¡‚â ¡â ¡â¡‘â ”â£…â¢¢â¢¡â¢¡â ¡â¡Šâ¡’â¢Œâ¢‚â¢•â¢•â¢¹â¢˜â œâ¢Œâ †â †â¢â ªâ ¡â¢Šâ ‚â ¢â ¨â¡â ”â ¨â Šâ¡€â „â …â¡â¢ˆâ €â¡‚â ¡",
"â¡Šâ¡€â ‚â â¡€â â ¨â  â¡ˆâ Œâ¡€â¢‚â â ”â ˆâ Œâ¡â¢€â ‚â Œâ¡‘â …â¡‚â ‘â „â Œâ¡ˆâ¢Œâ¢Œâ ¢â Šâ ’â â¡â¢‚â â „â …â ¡â ˆâ Œâ  â €â ¡â  â ¨â ¨â ˆâ¡€â¡‚â …â¡¢â ‚â¢â ¡â¢ˆâ €â¡â €â ‚",
"â£§â â¢ˆâ¢€â  â ˆâ  â â ¢â¡€â¡‚â „â¢‚â¢â €â â â  â¢€â ‚â  â ¡â ¨â ˆâ „â …â ˆâ  â €â¡ˆâ  â â¡â „â ‚â Œâ¡â  â ¡â¢‘â¢ˆâ ‚â¡Šâ Œâ ¨â ˆâ „â ¡â €â¡€â ‚â  â €â „â ‚â €â „â  â ˆâ¡€",
"â£¿â¡„â â  â¢€â ‚â â €â â €â ‚â¡â ‚â „â Šâ  â ¡â ˆâ €â¡ˆâ ¨â €â¡ˆâ ˆâ¡ˆâ ¨â¢ˆâ¢â €â ‚â ‚â¢â â €â â  â €â â €â €â €â¡€â¢€â €â¢â  â ˆâ €â …â €â ‚â ¡â¢€â â¡€â ‚â Œâ €â „â €",
};

const char* gun[] ={
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡„â£„â „â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¢â¢â¢€â¢¦â¢¢â¢¦â¢¦â¢ â¡ â¡¢â  â¡€â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â¡€â£¤â£³â ‹â ‰â ˆâ …â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡€â¡‚â£ªâ¢ºâ ¨â ¢â ±â¢±â ‘â •â  â €â €â ˆâ ˆâ ‚â €â €",
"â €â €â €â €â €â €â €â €â €â¡€â¡â¡œâ£œâ¢â¡„â €â €â €â €â €â €â €â €â €â €â €â €â €â¡€â¢„â¢‚â¢¢â ²â¡â¡â¡‡â¡â¡Šâ¢â¡˜â¡¬â ¨â ˆâ „â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â¢€â¢¢â¢±â¢±â¢½â£µâ¢±â ‘â „â „â¢„â €â €â €â¢€â  â  â €â¡€â ¢â ¨â¡‚â¡‡â¡³â ±â¡¡â£‘â¢…â ‘â¢œâ¢Œâ¢–â¡œâ¡µâ¡¡â¢±â €â €â €â €â €â €",
"â €â €â €â €â €â €â  â¡â£”â¢µâ¡±â£â¡½â£ºâ¡³â¡¥â¡¡â¡±â¡ â¡¡â¡‘â¡â¡â „â¢•â ”â¢Œâ¢Šâ¢Šâ¢Œâ¡–â£œâ¡®â£â¡®â£ªâ¡ªâ£³â¢³â¢µâ¢•â¡§â¡£â¡ªâ¡‡â¡„â¡€â €â €â €",
"â €â €â €â €â¢ˆâ¢¢â¢•â¢â¡®â£³â¡»â£ºâ¡ªâ¡£â¡«â£â¡·â£µâ¢µâ¢µâ£•â£•â¢¼â¢¬â£ â¢±â ±â¡•â£—â£½â£â¢¯â£ªâ¢“â «â «â¡«â¡•â¢µâ¢•â¡¯â£â¢µâ¡¸â¡¸â¡ â ‘â „â €â €",
"â €â €â €â €â¡â¡±â¡µâ£â£â¢§â¢â¡—â¡µâ£â¡½â¡½â£â¢½â£»â¢½â¢¾â¢¾â£½â£µâ£³â£¯â¢—â£â¢µâ¢—â¡—â¡µâ¡â ‚â …â¢…â¢‘â¢â¢•â¡‡â¡â¡—â¡•â â¡â¡â¡€â ¨â €â €",
"â €â €â €â£€â¢¢â¡«â£—â¢•â¢‡â¢—â¢½â¢±â¢±â¢ªâ¢ªâ¢«â¢ªâ¢ªâ¢ªâ¢¹â¢¹â¢½â¡½â£¯â¡·â£¿â£â¢®â¡«â£â¢Œâ ‡â †â €â €â €â ‚â¡‡â ‚â ‘â â ˜â¢”â ‡â ˆâ ªâ¡†â¡‚â €â €",
"â €â €â¢€â¢šâ¢œâ¢œâ¢®â¡³â££â¢«â¢—â¢•â¢•â¢•â •â¡•â¡•â¡•â¡•â£•â¢½â¢½â£»â¢¿â£â¡·â¡¹â¡¸â£â¢â â£œâ „â €â €â €â €â¡‡â €â €â €â €â ‚â¢¯â €â €â €â €â €â €",
"â €â €â â¡•â¡•â£½â¡â¡â¡®â¡ºâ£•â¢•â¢•â¢•â¢•â¢•â¢±â ±â ‘â¡…â¡¯â£»â¢â£—â¡·â¡½â¡˜â ¾â£•â¢‡â¢³â¢¯â£ªâ ¢â¡€â €â¢€â¢ƒâ¢€â¢€â €â €â ˆâ ˆâ €â €â €â €â €â €",
"â €â €â¢°â¢±â¢±â¡³â¡â¡œâ¡œâ£œâ¢®â¡ â£‡â¢‡â ‡â ƒâ â  â¡±â£¸â¢â£â£§â¢»â£â¢¿â¡½â£µâ¢¨â¡‚â¡€â â ‹â ³â ±â µâ£”â¡µâ¡•â¢â ‚â €â €â €â €â €â €â €â €â €",
"â €â¢€â¢ªâ¢¢â ±â¡¸â¡•â¢•â¢•â¢•â¢µâ¢â¢œâ œâ €â €â €â ¦â¢®â¡‡â£¯â£¾â¢¯â£³â¢§â£·â¡»â¡šâ ³â¡³â£Œâ¢†â „â €â ¨â ˆâ â €â¢â †â €â €â €â €â €â €â €â €â €â €",
"â €â¢°â ±â¡‘â¡‘â¡½â¡¸â¡°â¡±â¡±â¡±â£â¢â â €â €â Œâ£â¢œâ£½â£½â£»â£½â£ºâ¢½â¡ªâ¡€â¢ â¢ â¢€â¢±â¢«â¡³â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â â¡œâ¢Œâ ªâ¡ªâ¡ºâ¡¸â¡¸â¡¸â¡¸â¡¸â¡¸â£•â¢‡â €â  â ‘â£•â¢â£â£¯â¢»â¡—â “â ³â ™â ®â “â ‰â â¢€â¢â —â£Ÿâ „â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â ¨â¡˜â ”â •â¢Œâ ªâ¡³â¡â¡¼â£¸â¢¸â¡¸â£¸â¡²â£„â €â¢ â¢³â¢â¢¾â¡‡â¡—â¡•â €â €â €â €â €â €â €â ˆâ ˜â â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â ¨â¡ªâ ˆâ ˆâ €â ‘â¢â¢·â££â ƒâ¡—â â €â ˆâ ˜â •â ¦â£¸â¢¹â¢®â¡»â¡œâ¡Œâ €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â¡‡â €â €â €â €â €â ™â¡®â¡„â …â €â €â €â €â €â €â €â ˆâ «â£â£—â¡•â¡…â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â ±â €â €â €â €â €â €â ˆâ¢—â¡…â €â €â €â €â €â €â €â €â â ™â¢®â£—â¡‡â¡‡â „â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â â  â ¡â¡â ¢â¢â  â¡ˆâ¡šâ¢¦â¡€â €â €â €â €â €â €â €â „â …â “â¢â¢¯â¢§â¢§â¢¢â â „â¢•â¢€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â¢€â €â Œâ ¢â ¨â¡ˆâ ¢â¡‘â¡â¢Œâ ¢â¡â¡ƒâ¡‚â €â €â €â €â €â €â ¡â¢‘â¢â â¡”â •â â¡Œâ¢â¢â¢†â¢…â â¢€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â ˆâ €â ˆâ â Œâ ‚â ‚â …â …â £â ±â¡±â£Œâ¡†â¡„â …â …â¡€â €â €â €â €â ‘â ˆâ ˆâ €â ˆâ¢„â …â¢•â¢•â¢•â¢â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â ˆâ ‚â â â €â €â €â €â €â¢â ƒâ¡‹â£Ÿâ¢•â¢‡â¢—â¢¦â ‚â €â €â €â €â €â €â €â ˆâ €â €â â â¡‡â¡†â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â ‘â â ‘â ‰â £â¡‡â¡…â¡•â¡¤â£€â €â €â €â €â €â €â €â €â¡€â£”â¢¼â ±â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ ™â ˜â šâ ¶â ²â¢”â¢†â¢—â •â •â â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
};

const char* Orb[] = {

"â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â¡¤â£”â¡²â¢®â¡¹â£â¢â¡—â£³â¢²â¡¤â£„â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â¢€â¡´â£Šâ¢â ¶â£¡â¢›â¢¦â ³â¡œâ£â â£¥â¡“â¡â£­â£›â ¶â£„â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â£°â¢«â ´â¡‰â¢Œâ¢¢â ±â£â¢²â¡¹â¡œâ£¬â¢›â¡´â¡¹â£œâ¡±â£â¢Ÿâ¡¼â£³â „â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â¢€â¡â¡¥â£“â ¢â£‰â †â¡â¡µâ£Šâ¢§â¡±â£™â¢¦â£‹â ¶â¡±â¢â¡µâ¢ªâ¢â¡¾â£±â¢»â£„â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â¡œâ¢®â¡±â¢â¡µâ¢Šâ¡¼â¢±â¡±â¡â¢¶â¡±â£â ¶â£©â¢â¡±â¢«â¡¼â£™â¢®â¡µâ£«â¢—â¡¾â¡„â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â¢°â£‹â¢§â ³â£â ¶â£©â â¡±â¢â¡â¢¦â ³â£¬â¢³â¡±â¢â¡â££â â£¥â¢³â¡ºâ£µâ¢«â¡â£·â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â¢¸â¡­â¢â¡³â£¬â ³â£¥â¢«â¡•â£«â¡œâ££â£›â ´â££â¡â¡ºâ¡œâ£¥â »â£œâ££â ·â£­â¢³â£»â£¼â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â¢¸â¢§â¢«â¡µâ£Šâ ·â£¬â ³â¡¼â£±â¢šâ¡µâ¢ªâ¡â¢¶â¡©â¢—â¡¹â¡¼â£™â ¾â£¼â¡¹â£â£¯â¢—â¡¾â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â ˜â£â¢·â£šâ¡­â¡â£¥â¡›â¢¶â£™â¢®â¡œâ¢§â¡â¡®â¢µâ£‹â¢·â¡¹â£­â£›â¢¶â£¹â¢³â¡®â£Ÿâ¡â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â ¹â£â¢·â¡³â£â¢¶â£¹â¢£â£â¢¶â¡¹â¢â¡¼â£™â¢§â¡â£®â¢³â¢§â£›â£®â¢½â£³â¢»â¡¼â â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â ›â£®â¡³â£â£®â¢³â¢¯â¡œâ£®â¢³â£â¢¾â£™â¢®â£â¢®â£›â¡®â¢·â£šâ£¯â ¾â¡½â â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â ˜â ½â£³â¢â¡½â£®â£â¢®â¡—â£®â¡³â£½â£šâ£®â¢¯â£³â¢Ÿâ£¯â ½â£®â ‹â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â ‰â ºâ¢½â£–â¢¯â£³â¢¯â£³â¡½â¢§â£Ÿâ¢®â¡Ÿâ£µâ£»â â¡‹â „â£€â €â¡€â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â â ‚â Œâ ‹â “â ¯â ³â ¿â ½â šâ ›â¢šâ ¡â ƒâ œâ €â ƒâ €â ‚â €â €â €â €â €â €â €â €â €",
"                                                           "
};

const char* brokenOrb[] = {
"â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£€â£€â¡€â €â €â €â£ â£€â£„â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â£ â¡¤â¢¾â¡¹â¢­â£«â ½â£„â €â €â£½â£¿â¡¼â£¹â¢›â¡¶â£„â¡€â €â €â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â£ â¡â¢§â¡‰â¢§â¡¹â¢³â¡¬â£›â¢¾â¡€â °â£¿â¡½â£·â¢­â£›â¡¼â¢³â£»â¢¦â¡€â €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â£ â¡â¢§â¡™â¢¤â¡˜â¡¶â£™â §â¡â£­â¢â¡‡â €â ¸â£¿â£½â¡®â£µâ£‹â¢·â¡¹â£â¢¿â£„â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â£ â¢Ÿâ¡¼â¢£â¡œâ£¦â¢›â¡µâ¢­â£šâ ½â£²â ­â¡‡â €â €â£¿â£â£·â¢£â£â££â¢Ÿâ¡¼â£â¡¿â£¦â €â €â €â €â €â €â €",
"â €â €â €â €â €â¢ â¡Ÿâ£â¡’â¢¯â¡œâ£–â£«â¡œâ¡³â¢â£›â¡–â¢¯â¡‡â €â €â£¿â£â£¯â¢³â¢â£§â¢»â¡¼â£«â£½â£»â¡„â €â €â €â €â €â €",
"â €â €â €â €â €â¢¸â£â¡²â¡â¡§â¢â ¶â£±â â£­â£›â¡¼â£šâ¡³â¡†â €â €â£¿â£â£¯â£â¡¾â£œâ£§â£›â¡·â£¯â¢·â¡—â €â €â €â €â €â €",
"â €â €â €â €â €â¡¿â£œâ£§â£¿â£¾â¢¯â£¿â£¾â£¿â£¶â£¿â£¾â£·â¡¿â ƒâ €â €â ·â ›â »â ¿â Ÿâ ¿â ¿â¢¿â£¿â£¿â¡¿â ¿â €â €â €â €â €â €",
"â €â €â €â €â €â ™â ›â ›â ³â ›â ‰â â ˆâ â €â €â €â €â €â €â €â €â €â£€â£¤â£ â£„â£€â£€â£€â ˆâ €â €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â£€â£ â£¤â¡´â¢¶â£ºâ¢»â¢­â¡›â£Ÿâ¡»â£›â¡Ÿâ¡‡â €â €â£¿â£¿â£â ·â£­â¢¯â£â¢¯â£Ÿâ¡¿â£·â¡„â €â €â €â €â €â €",
"â €â €â €â €â €â €â£Ÿâ¡³â¢®â¡â£§â¢³â¡â£â¡¹â¢¶â¡¹â£µâ£šâ¡‡â €â €â£¿â£½â¢â¡¿â£œâ£³â£â£»â¢¾â£½â£³â ƒâ €â €â €â €â €â €",
"â €â €â €â €â €â €â ˜â£Ÿâ£¯â ¾â£µâ¢«â¡â£µâ¢«â¢·â¡¹â£–â¡½â¡†â €â¢°â£¿â£½â¡ºâ£µâ£«â£â¡¾â£½â¢¯â£â ƒâ €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â ˜â¢¯â£Ÿâ£¾â¢³â£»â£¼â¢«â£â¡µâ£â£¾â ‡â €â£¾â¢¯â£·â£»â£µâ£»â¢¾â¡½â£¯â ¿â ƒâ €â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â ™â ¾â£¯â¡·â£¯â£Ÿâ£¾â£³â¡½â¡â €â¢°â£¿â£Ÿâ£¾â£³â¢¯â£Ÿâ£¯â Ÿâ ‹â¢€â €â¡€â €â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â  â â¢ â ›â ³â ¿â£â£·â¡¿â â¡„â¢»â£¿â¡¾â£³â ¿â¢›â ©â¢‚â œâ¡ˆâ †â ’â¢€â â €â €â €â €â €â €",
"â €â €â €â €â €â €â €â €â €â €â €â €â ˆâ €â â €â €â €â â €â â €â â €â â ˆâ €â â €â €â €â €â €â €â €â €â €â €â €â €",
"                                                           "
};

// ASCII ì•„íŠ¸ë¥¼ ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜
void printArt(const char* art[], int lineCount) {
    for (int i = 0; i < lineCount; i++) {
        // art ë°°ì—´ì˜ ê° ë¬¸ìì—´ì´ ë¹„ì–´ìˆì§€ ì•Šì€ ê²½ìš°ì—ë§Œ ì¶œë ¥
        if (art[i] && strlen(art[i]) > 0) {
            printf("%s\n", art[i]);
        }
    }
}

// ìŠ¤í† ë¦¬ ì¬ìƒ í•¨ìˆ˜ (êµ¬ì¡°ì²´ ì‚¬ìš© ì•ˆí•¨)
void playStory(const char** arts[], const int art_lines[], const char* texts[], int frameCount) {
    struct termios oldt, newt;
    // í‚¤ ì…ë ¥ì´ ë°”ë¡œ ë°˜ì˜ë˜ë„ë¡ í„°ë¯¸ë„ ì„¤ì • ë³€ê²½
    tcgetattr(STDIN_FILENO, &oldt);
    newt = oldt;
    newt.c_lflag &= ~(ICANON | ECHO);
    tcsetattr(STDIN_FILENO, TCSANOW, &newt);

    for (int i = 0; i < frameCount; i++) {
        // 1. í™”ë©´ ì „ì²´ë¥¼ ì§€ìš´ë‹¤.
        printf("\033[2J");
        
        // 2. ì»¤ì„œë¥¼ ë§¨ ìœ„(1,1)ë¡œ ì˜®ê¸´ë‹¤.
        printf("\033[1;1H");

        // 3. í˜„ì¬ í”„ë ˆì„ì˜ ì‚½í™”ë¥¼ ì¶œë ¥í•œë‹¤.
        if (arts[i] != NULL) {
            printArt(arts[i], art_lines[i]);
            printf("\n"); // ì‚½í™”ì™€ ëŒ€ì‚¬ ìƒì ì‚¬ì´ì— í•œ ì¤„ ê³µë°± ì¶”ê°€
        } else {
            // ì‚½í™”ê°€ ì—†ì„ ê²½ìš°, ëŒ€ì‚¬ë¥¼ í™”ë©´ ì¤‘ì•™ì— í‘œì‹œí•˜ê¸° ìœ„í•´ ì»¤ì„œ ì´ë™
            printf("\033[11;1H");
        }

        // 4. ëŒ€ì‚¬ ìƒìë¥¼ ê·¸ë¦°ë‹¤.
        printf(" %-75s \n", texts[i]);

        
        // 5. ì¶œë ¥ ë²„í¼ë¥¼ ë¹„ì›Œ í™”ë©´ì— ì¦‰ì‹œ í‘œì‹œ
        fflush(stdout);
        
        // 6. ë‹¤ìŒ ì¥ë©´ìœ¼ë¡œ ë„˜ì–´ê°€ê¸° ì „ ì ì‹œ ëŒ€ê¸°
        sleep(STORY_DELAY);
    }
    
    // ë§ˆì§€ë§‰ì— ì‚¬ìš©ì ì…ë ¥ ëŒ€ê¸°
    printf("\n(ê³„ì†í•˜ë ¤ë©´ ì—”í„°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”)");
    fflush(stdout);
    // ë²„í¼ì— ë‚¨ì•„ìˆì„ ìˆ˜ ìˆëŠ” ë¬¸ìë¥¼ ë¹„ìš°ê³  ì…ë ¥ì„ ê¸°ë‹¤ë¦¼
    while(getchar() != '\n' && getchar() != EOF);
    getchar();

    // í„°ë¯¸ë„ ì„¤ì •ì„ ì›ë˜ëŒ€ë¡œ ë³µêµ¬
    tcsetattr(STDIN_FILENO, TCSANOW, &oldt);
}

int main(void) {

    // // --- ì˜¤í”„ë‹ ìŠ¤í† ë¦¬ ë°ì´í„° ---
    // const char** intro_arts[] = {
    //     dragon, dragon, dragon, NULL, dragonBoss, dragonBoss, dragonBoss, dragonBoss,
    //     dragonFight, dragonFight, dragonFight, dragonBoss, NULL, NULL, NULL
    // };
    // const int intro_art_lines[] = {
    //     sizeof(dragon)/sizeof(dragon[0]), sizeof(dragon)/sizeof(dragon[0]), sizeof(dragon)/sizeof(dragon[0]), 0,
    //     sizeof(dragonBoss)/sizeof(dragonBoss[0]), sizeof(dragonBoss)/sizeof(dragonBoss[0]), sizeof(dragonBoss)/sizeof(dragonBoss[0]), sizeof(dragonBoss)/sizeof(dragonBoss[0]),
    //     sizeof(dragonFight)/sizeof(dragonFight[0]), sizeof(dragonFight)/sizeof(dragonFight[0]), sizeof(dragonFight)/sizeof(dragonFight[0]),
    //     sizeof(dragonBoss)/sizeof(dragonBoss[0]), 0, 0, 0
    // };
    // const char* intro_texts[] = {
    //     "ë¨¼ ì˜›ë‚ , ë“œë˜ê³¤ë“¤ì´ í‰í™”ë¡­ê²Œ ì‚´ì•„ê°€ëŠ” ì²œê³µì˜ ë‘¥ì§€ê°€ ìˆì—ˆë‹¤.",
    //     "ê·¸ê³³ì€ ì™¸ë¶€ì˜ ê°„ì„­ ì—†ì´ ë“œë˜ê³¤ë“¤ì´ ì•Œì„ ë‚³ê³  í‚¤ìš°ëŠ” ì‹ ì„±í•œ ì¥ì†Œì˜€ë‹¤.",
    //     "ê·¸ê³³ì—ëŠ” ì•„ì§ ì–´ë¦° ë“œë˜ê³¤ ê³¤ê³¼ ê·¸ì˜ ì–´ë¯¸, ê·¸ë¦¬ê³  ê³§ íƒœì–´ë‚  ë™ìƒë“¤ì˜ ì•Œì´ ìˆì—ˆë‹¤.",
    //     "ê·¸ëŸ¬ë˜ ì–´ëŠë‚ ...",
    //     "ì˜¤ëœì ì—ì„œ ê¹¨ì–´ë‚œ ê³ ëŒ€ì˜ íŒŒë©¸ì 'í˜¼í…Œì¼'ì´ ë‚˜íƒ€ë‚¬ë‹¤.",
    //     "ê·¸ëŠ” ëì—†ëŠ” í—ˆê¸°ì™€ íƒìš•ìœ¼ë¡œ ë¨¹ì‡ê°ì„ ì°¾ì•„ ì„¸ìƒì„ ëŒì•„ë‹¤ë…”ë‹¤.",
    //     "ê·¸ì˜ ë°œê¸¸ì´ ë‹¿ëŠ” ê³³ë§ˆë‹¤ ìƒëª…ì€ ì‚¬ë¼ì§€ê³ , íí—ˆë§Œì´ ë‚¨ì•˜ë‹¤.",
    //     "ê·¸ëŸ¬ë‹¤ ê²°êµ­... ê·¸ëŠ” ì²œê³µì˜ ë‘¥ì§€ë¥¼ ë°œê²¬í–ˆë‹¤.",
    //     "ì–´ë¯¸ ë“œë˜ê³¤: â€œê³¤, ìˆ¨ì–´ìˆì–´ë¼.. ì ˆëŒ€ ì›€ì§ì´ë©´ ì•ˆ ë¼â€",
    //     "ì–´ë¯¸ ë“œë˜ê³¤ì€ ê³¤ì—ê²Œ ë§ˆì§€ë§‰ ë‹¹ë¶€ë¥¼ ë‚¨ê¸°ê³  í˜¼í…Œì¼ê³¼ ë§ì„œ ì‹¸ì› ë‹¤.",
    //     "í•˜ì§€ë§Œ ì–´ë¯¸ë“œë˜ê³¤ê³¼ í˜¼í…Œì¼ì˜ í˜ì˜ ì°¨ì´ëŠ” ë„ˆë¬´ì»¸ê³ , ì–´ë¯¸ë“œë˜ê³¤ì€ ì“°ëŸ¬ì¡Œë‹¤.",
    //     "í˜¼í…Œì¼ì€ ë‘¥ì§€ ì•ˆì˜ ì•„ì§ ë¶€í™”í•˜ì§€ ëª»í•œ ì•Œë“¤ì„ ë¨¹ì–´ì¹˜ìš´ í›„ ë– ë‚¬ë‹¤.",
    //     "ê·¸ ëª¨ë“  ê±¸ ì§€ì¼œë´ì•¼ë§Œ í–ˆë˜ ê³¤ì€, ì¡°ìš©íˆ ìˆ¨ì„ ì£½ì¸ ì±„ ëª¸ì„ ë–¨ì—ˆë‹¤.",
    //     "ëª¨ë“  ê²ƒì´ ë¬´ë„ˆì§„ ê·¸ ìˆœê°„, ì‘ì€ ë“œë˜ê³¤ ê³¤ì˜ ë§ˆìŒ ì†ì—” ë³µìˆ˜ì˜ ë¶ˆì”¨ê°€ í”¼ì–´ì˜¬ëë‹¤.",
    //     "ê·¸ë¦¬í•˜ì—¬â€¦ ì–´ë¦° ë“œë˜ê³¤ì˜ ë³µìˆ˜ì˜ ì—¬ì •ì´ ì‹œì‘ë˜ì—ˆë‹¤.",
    // };
    // int intro_frameCount = sizeof(intro_texts) / sizeof(intro_texts[0]);
    //                                   // --- ìŠ¤í† ë¦¬ ì¬ìƒ ---
    
    // sleep(1);
    // playStory(intro_arts, intro_art_lines, intro_texts, intro_frameCount);

    char map_backup[ROW][COL];
    char map[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1mmm000000000000000000000000000000000001",
        "1m7m000000000000000000000000000000000001",
        "1mmm000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "100000000000000000000000000000000000mmm1",
        "100000000000000000000000000000000000m4m1",
        "100000000000000000000000000000000000mmm1",
        "100000000000000z0000000c0000000000000001",
        "1000000000000000000000000000000000000001",
        "1mmm000000000000000000000000000000000001",
        "1m5m000000000000000000000000000000000001",
        "1mmm000000000000000n00000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "100000000000000000000000000000000000mmm1",
        "100000000000000000000000000000000000m3m1",
        "100000000000000000000000000000000000mmm1",
        "1111111111111111111111111111111111111111"
    };
    char map1[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000901",
        "1111111111111111111111111111111111111111"
    };
    char map2[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000901",
        "1111111111111111111111111111111111111111"
    };
    char map3[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000600001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000901",
        "1111111111111111111111111111111111111111"
    };
    char map4[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000501",
        "1111111111111111111111111111111111111111"
    };
    char map5[ROW][COL] = {
        "1111111111111111111111111111111111111111",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000901",
        "1111111111111111111111111111111111111111"
    };

    // int playerX = 1, playerY = 18;
    int npcX = 19;  // â¬…ï¸ ì—¬ê¸°ì— ì¶”ê°€
    int npcY = 12;  // â¬…ï¸ ì—¬ê¸°ì— ì¶”ê°€
    int fire_dx = 1, fire_dy = 0;
    char* currentMapName = "ë§ˆì„";
    int gold = 1000;
    int potion1_hp = 0;
    int potion2_hp = 0;
    int potion3_hp = 0;
    int playerHP = 100;
    int playerMaxHP = 100;
    int a=0; // ë˜ì „ 5(ë³´ìŠ¤ë§µ)ì— ë“¤ì–´ê°”ì„ ë•Œ í•œë²ˆ ì£½ëŠ” ì½”ë“œ
    memcpy(map_backup, map, sizeof(map));
    enableRawMode();

    // ë©”ì¸ ê²Œì„ ë£¨í”„ (ê²Œì„ ì¬ì‹œì‘ì„ ìœ„í•´ ì™¸ë¶€ ë£¨í”„ ì¶”ê°€)
    while (1) {
                // ë˜ì „ 5(ë³´ìŠ¤ë§µ)ì— ë“¤ì–´ê°”ì„ ë•Œ í•œë²ˆ ì£½ëŠ” ì½”ë“œ
        if (a==32){
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("âš« ìµœì¢… ë˜ì „ 5ì— ì…ì¥í•˜ì…¨ìŠµë‹ˆë‹¤...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000);
            memcpy(map, map5, sizeof(map));
            playerX = 1;
            playerY = 18;
            currentMapName = "ë˜ì „ 5 (ìµœì¢… ë³´ìŠ¤)";
            monsterCount = 0;
            spawnMonster(20, 10, 4); // í˜¼í…Œì¼
            a++;
        }
        if (a==31){
            printf("\033[H\033[J");
            printf("\n\n\n\n\n");
            printf("------------------------------------------------------- \n\n");            
            printf("                  ë³´ìŠ¤ì „ì„ ì‹œì‘ í•©ë‹ˆë‹¤.  \n");
            printf("-------------------------------------------------------\n");
            printf("\n\n           ì•„ë¬´ í‚¤ë‚˜ ëˆŒëŸ¬ ì¬ì‹œì‘í•˜ì„¸ìš”...\n");
            fflush(stdout);
            getch();
            resetGame(&playerX, &playerY, &playerHP, &playerMaxHP, &currentMapName, map, map_backup);
            a++;
            //ì—¬ì˜ì£¼ ì•„ì´í…œ ì¶”ê°€
            inventory[0] += 1;
            inventory[9] = 1; // ì—¬ì˜ì£¼ ì•„ì´í…œ íšë“
            // ì—¬ì˜ì£¼ ìŠ¤í† ë¦¬ í›„ í”Œë ˆì´ì–´ ì´ëª¨ì§€ ë³€ê²½
            currentEmoji = 1;  // ìš©ìœ¼ë¡œ ë³€ê²½
            playerEmojis[currentEmoji] = "ğŸ‰ ";
            printf("\nğŸ‰ í”Œë ˆì´ì–´ ì´ëª¨ì§€ê°€ ë±€ì—ì„œ ìš©ìœ¼ë¡œ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤!\n");            
        }
        if (a==30){
                // --- ì¤‘ê°„ ìŠ¤í† ë¦¬ ë°ì´í„° ---
            const char** middle_arts[] = {
                NULL, dragonBoss, dragonBoss, NULL, brokenOrb, Orb, NULL, NULL, NULL, Orb, gun, gun
            };
            const int middle_art_lines[] = {
                0, sizeof(dragonBoss)/sizeof(dragonBoss[0]), sizeof(dragonBoss)/sizeof(dragonBoss[0]), 0, sizeof(brokenOrb)/sizeof(brokenOrb[0]), sizeof(Orb)/sizeof(Orb[0]), 0, 0,0,
                sizeof(Orb)/sizeof(Orb[0]), sizeof(gun)/sizeof(gun[0]), sizeof(gun)/sizeof(gun[0])
            };
            const char* middle_texts[] = {
                "ê¸´ ì—¬ì • ëì— í˜¼í…Œì¼ì„ ë§Œë‚˜ ì‹¸ìš°ê²Œëœ ê³¤.",
                "ë³µìˆ˜ë¥¼ ë‹¤ì§í–ˆë˜ ê·¸ì˜€ì§€ë§Œ í˜¼í…Œì¼ ì•ì— ê·¸ëŠ” ë„ˆë¬´ ì•½í–ˆë‹¤.",
                "í˜¼í…Œì¼: â€œí•˜ì°®ì€ ì”ì±™ì´ê°€ ê°íˆ ë‚˜ì—ê²Œ ë³µìˆ˜ë¥¼ ê¿ˆê¾¸ë‹¤ë‹ˆ...â€",
                "\n\n\n\n\n------------------------------------------------------\n         í”Œë ˆì´ì–´ì˜ ì²´ë ¥ì´ ëª¨ë‘ ì†Œì§„ë˜ì—ˆìŠµë‹ˆë‹¤.  \n------------------------------------------------------",
                "ê³¤ì´ ì“°ëŸ¬ì§„ì±„ ëˆˆì•ì´ íë ¤ì§€ëŠ” ìˆœê°„, ì–´ë¨¸ë‹ˆì™€ í˜•ì œë“¤ì˜ í™˜ì˜ì´ ë– ì˜¤ë¥¸ë‹¤.",
                "ê·¸ë•Œ, ê³¤ì´ ì—¬ì •ì„ í†µí•´ ëª¨ì€ ì—¬ì˜ì£¼ ì¡°ê° 4ê°œê°€ ë¹›ì„ ë‚´ë©° í•˜ë‚˜ë¡œ í•©ì³ì§„ë‹¤.",
                "ì—¬ì˜ì£¼: â€œ...ì‘ì€ ë“œë˜ê³¤ì´ì—¬..ë‚˜ì˜ í˜ì´ í•„ìš”í•œê°€?â€",
                "ê³¤ì´ ë§ˆì§€ë§‰ í˜ì„ ì§œë‚´ ë§í•œë‹¤.",
                "ê³¤: â€œë„¤.. ì €ì—ê²Œ í˜ì„ ì£¼ì„¸ìš”... ì—„ë§ˆì˜ ë³µìˆ˜ë¥¼...â€",
                "ìˆœê°„, ì—¬ì˜ì£¼ì—ì„œ ì°¬ë€í•œ ë¹›ì´ ë‚˜ì™€ ê³¤ì„ ê°ì‹¸ê³ ",
                "ê³¤ì˜ ëª¸ì€ ì ì  ê±°ëŒ€í•´ì§€ë©° ì„±ì¸ ë“œë˜ê³¤ì˜ ëª¨ìŠµìœ¼ë¡œ ë°”ë€ë‹¤.",
                "ê³¤ì€ ì™„ì „íˆ ê°ì„±í•œ ì±„, í˜¼í…Œì¼ì—ê²Œ ë‹¤ì‹œ ë‚ ì•„ë“ ë‹¤.",
            };
            int middle_frameCount = sizeof(middle_texts) / sizeof(middle_texts[0]);
            printf("\033[2J\033[1;1H"); // í™”ë©´ì •ë¦¬
            sleep(1);
            playStory(middle_arts, middle_art_lines, middle_texts, middle_frameCount);
            a++;
        }
        if (a>=1 && a<30){
            a++;
        }
        

        // ê²Œì„ì˜¤ë²„ ì²´í¬
        if (playerHP <= 0) {
            printf("\033[H\033[J");
            printf("\n\n\n\n\n");
            printf("------------------- ğŸ’€ ê²Œì„ ì˜¤ë²„ ğŸ’€ ------------------- \n\n");            
            printf("         í”Œë ˆì´ì–´ì˜ ì²´ë ¥ì´ ëª¨ë‘ ì†Œì§„ë˜ì—ˆìŠµë‹ˆë‹¤.  \n");
            printf("         ë§ˆì„ë¡œ ëŒì•„ê°€ ì¬ì‹œì‘í•©ë‹ˆë‹¤...          \n\n");
            printf("-------------------------------------------------------\n");
            printf("\n\n           ì•„ë¬´ í‚¤ë‚˜ ëˆŒëŸ¬ ì¬ì‹œì‘í•˜ì„¸ìš”...\n");
            fflush(stdout);
            getch();
            resetGame(&playerX, &playerY, &playerHP, &playerMaxHP, &currentMapName, map, map_backup);
            continue;
        }

        static int firstDraw = 1;
        printf("\033[2J\033[H");
        printf("ğŸŸ¢ : ë˜ì „1 ğŸ”µ : ë˜ì „2 ğŸ”´ : ë˜ì „3 ğŸšª : íˆë“ ë§µ âš« : ë³´ìŠ¤ ğŸŒ€ : ë§ˆì„ê·€í™˜ ğŸ¥ : ë¬¼ì•½ìƒì  ğŸ•Œ : ì¹´ì§€ë…¸ ğŸ¤– : NPC\n\n");
        printf("\nğŸŒ í˜„ì¬ ë§µ: [%s]", currentMapName);
        printf("                                                                             í”Œë ˆì´ì–´ ìœ„ì¹˜: (%d, %d)\n", playerX, playerY);

        for (int i = 0; i < ROW; i++) {
            for (int j = 0; j < COL; j++) {
                if (i == playerY && j == playerX) {
                    printf("%s", playerEmojis[currentEmoji]);
                    continue;
                }
                int fireballHere = 0;
                for (int f = 0; f < MAX_FIREBALLS; f++) {
                    if (fireballs[f].active && fireballs[f].x == j && fireballs[f].y == i) {
                        printf(fireballs[f].is_monster_bullet ? "ğŸ’§ " : "ğŸ”¥ "); // ëª¬ìŠ¤í„° íƒ„í™˜ì€ ğŸ’§ (ì¶”ê°€)
                        fireballHere = 1;
                        break;
                    }
                }
                if (fireballHere) continue; 
                int monsterHere = 0;
                for (int m = 0; m < monsterCount; m++) {
                    if (monsters[m].alive && monsters[m].x == j && monsters[m].y == i) {
                        printf("%s ", monsterEmojis[monsters[m].type]);
                        monsterHere = 1;
                        break;
                    }if (monsters[m].alive && monsters[m].x+1 == j && monsters[m].y == i) {
                        printf("%-3d", monsters[m].hp);
                        monsterHere = 1;
                        break;
                    }
                    
                }
                if (monsterHere) continue;
                if (map[i][j] == '0') printf("   ");
                else if (map[i][j] == '1') printf("ğŸŒ´ ");
                else if (map[i][j] == '2') printf("ğŸŸ¥ ");
                else if (map[i][j] == '3') printf("ğŸŸ¢ ");
                else if (map[i][j] == '4') printf("ğŸ”µ ");
                else if (map[i][j] == '5') printf("ğŸ”´ ");
                else if (map[i][j] == '6') printf("ğŸšª ");
                else if (map[i][j] == '7') printf("âš« ");
                else if (map[i][j] == '9') printf("ğŸŒ€ ");
                else if (map[i][j] == 'z') printf("ğŸ¥ ");
                else if (map[i][j] == 'c') printf("ğŸ•Œ ");
                else if (map[i][j] == 'n') printf("ğŸ¤– ");
                else if (map[i][j] == 'm') printf("ğŸŸ« ");
            }
            printf("\n");
        }

        // ìƒíƒœì°½ ì§ì ‘ ì¶œë ¥ ì¶”ê°€
        printf("â¤ï¸   HP: %d/%d", playerHP, playerMaxHP);
        printf("                                                                                           ğŸ’° Gold: %d\n", gold);

        // âœ… í€˜ìŠ¤íŠ¸ ì¶œë ¥ ì½”ë“œ ì¶”ê°€
        char* questNames[5] = {
            "ë‹¬íŒ½ì´", "ë„ë§ˆë±€", "ë…ê±°ë¯¸", "ë“œë¼í˜ë¼", "í˜¼í…Œì¼"
        };

        // í€˜ìŠ¤íŠ¸ ìˆ˜ì¹˜ ì¡°ê±´ 
        int questKillTargets[5] = {10, 10, 10, 1, 1};   // í€˜ìŠ¤íŠ¸ ëª¬ìŠ¤í„° ì¡°ê±´ ìˆ˜ì¹˜ 
        int questItemTargets[5] = {5, 5, 5, 1, 1};    // í€˜ìŠ¤íŠ¸ ì•„ì´í…œ ì¡°ê±´ ìˆ˜ì¹˜
        char* questItemNames[5] = {
            "ë“±ê»ì§ˆ",       // ë‹¬íŒ½ì´
            "ë¹„ëŠ˜",         // ë„ë§ˆë±€
            "ì†¡ê³³ë‹ˆ",       // ë…ê±°ë¯¸
            "ì‹¬ì¥",         // ë“œë¼í˜ë¼
            "ì •ìˆ˜"          // í˜¼í…Œì¼
        };

        printf("\nğŸ¯  í€˜ìŠ¤íŠ¸ ì§„í–‰ ìƒíƒœ \n");
        for (int i = 0; i < 5; i++) {
            if (questAccepted[i] && !questCompleted[i]) {
                printf("  %d. %s: ì§„í–‰ ì¤‘... (%d/%d ë§ˆë¦¬, %s: %d/%d)\n", 
                    i + 1, questNames[i], 
                    questKillCount[i], questKillTargets[i], 
                    questItemNames[i], questItemCount[i], questItemTargets[i]);
            } else if (questCompleted[i] && !rewardGiven[i]) {
                printf("  %d. %s í€˜ìŠ¤íŠ¸ ì™„ë£Œë¨! (ë³´ìƒ ìˆ˜ë ¹ ëŒ€ê¸° ì¤‘) ğŸ\n", i + 1, questNames[i]);
            } else if (questCompleted[i] && rewardGiven[i]) {
                printf("  %d. %s: ì™„ë£Œ âœ…\n", i + 1, questNames[i]);
            }
        }

        // í€˜ìŠ¤íŠ¸ ì™„ë£Œ í›„ ë³´ìƒ 

        if (questAccepted[0] && !questCompleted[0])
            printf(" ");
        else if (questCompleted[0] && !rewardGiven[0]) {
            printf("ğŸ¤– NPC: â€œì˜í–ˆë„¤. ì´ê±´ ë³´ìƒì´ë„¤.â€\n");
            gold += 100;
            inventory[0] += 1; // ì—¬ì˜ì£¼ ì¡°ê°
            rewardGiven[0] = 1;
            printf("ğŸ’° ë³´ìƒ: ê³¨ë“œ +100, ì—¬ì˜ì£¼ ì¡°ê° +1\n");
            usleep(1500000);
            playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
            playerY = npcY;
        }

        if (questAccepted[1] && !questCompleted[1])
            printf(" ");
        else if (questCompleted[1] && !rewardGiven[1]) {
            printf("ğŸ¤– NPC: â€œë„ë§ˆë±€ê¹Œì§€ í•´ì¹˜ìš°ë‹¤ë‹ˆ! ì‹¤ë ¥ ì¸ì •í•˜ë„¤.â€\n");
            gold += 200;
            inventory[0] += 1; // ì—¬ì˜ì£¼ ì¡°ê°
            rewardGiven[1] = 1;
            printf("ğŸ’° ë³´ìƒ: ê³¨ë“œ +200, ì—¬ì˜ì£¼ ì¡°ê° +1\n");
            usleep(1500000);
            playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
            playerY = npcY;
        }

        if (questAccepted[2] && !questCompleted[2])
            printf(" ");
        else if (questCompleted[2] && !rewardGiven[2]) {
            printf("ğŸ¤– NPC: â€œë…ê±°ë¯¸ê¹Œì§€ í•´ì¹˜ìš°ë‹¤ë‹ˆ! ì‹¤ë ¥ ì¸ì •í•˜ë„¤.â€\n");
            gold += 1000;
            inventory[0] += 1; // ì—¬ì˜ì£¼ ì¡°ê°
            rewardGiven[2] = 1;
            printf("ğŸ’° ë³´ìƒ: ê³¨ë“œ +1000, ì—¬ì˜ì£¼ ì¡°ê° +1\n");
            usleep(1500000);
            playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
            playerY = npcY;
        }

        if (questAccepted[3] && !questCompleted[3])
            printf(" ");
        else if (questCompleted[3] && !rewardGiven[3]) {
            printf("ğŸ¤– NPC: â€œë“œë¼í˜ë¼ ê¹Œì§€ í•´ì¹˜ìš°ë‹¤ë‹ˆ! ì‹¤ë ¥ ì¸ì •í•˜ë„¤.â€\n");
            gold += 2000;
            inventory[0] += 1; // ì—¬ì˜ì£¼ ì¡°ê°
            rewardGiven[3] = 1;
            printf("ğŸ’° ë³´ìƒ: ê³¨ë“œ +2000, ì—¬ì˜ì£¼ ì¡°ê° +1\n");
            usleep(1500000);
            playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
            playerY = npcY;
        }
        
        printf("\n\n í¬ì…˜ â–¶ 1,2,3 í‚¤ë¡œ ì¦‰ì‹œ ì‚¬ìš© \n");
        printf(" ğŸ’š í•˜ê¸‰ : %d ê°œ ğŸ’™ ì¤‘ê¸‰ : %d ê°œ ğŸ’– ìƒê¸‰ : %d ê°œ \n", potion1_hp, potion2_hp, potion3_hp);
    
        char input = getch_nonblock();
        // íŒŒì´ì–´ë³¼
        if (input == 'f' || input == 'F') {
            spawnFireball(playerX, playerY, fire_dx, fire_dy, 0, 10); // ğŸ”¥ ê¸°ë³¸ íŒŒì´ì–´ë³¼ 10 ë°ë¯¸ì§€
        }
        // ë©”í…Œì˜¤
        if (input == 'R' || input == 'r') {
            castMeteor();
        }

        // ë“œë˜ê³¤ ë¸Œë ˆìŠ¤
        if (input == 'E' || input == 'e') {
            castDragonBreath(playerX, playerY, fire_dx, fire_dy, 0);
        }

        if (input == 0) {
            updateFireballs(map, &playerHP, &playerMaxHP, playerX, playerY);
            updateMonsters(playerX, playerY, map); // ëª¬ìŠ¤í„° ì—…ë°ì´íŠ¸ (ì¶”ê°€)
            usleep(30000);
            continue;
        }
        if (input == 0x1b) {
            char next1 = getch();
            char next2 = getch();
            if (next1 == '[') {
                if (next2 == 'A') { input = 'A'; fire_dx = 0; fire_dy = -1; dirX = 0; dirY = -1; } // â†‘
                else if (next2 == 'B') { input = 'B'; fire_dx = 0; fire_dy = 1; dirX = 0; dirY = 1; }  // â†“
                else if (next2 == 'C') { input = 'C'; fire_dx = 1; fire_dy = 0; dirX = 1; dirY = 0; }  // â†’
                else if (next2 == 'D') { input = 'D'; fire_dx = -1; fire_dy = 0; dirX = -1; dirY = 0; } // â†

            }
        }
        if (input == '1') {
            if (potion1_hp > 0) {
                potion1_hp--;
                playerHP += 10;
                if (playerHP > playerMaxHP) playerHP = playerMaxHP;
                printf("\n ğŸ’š í•˜ê¸‰ í¬ì…˜ ì‚¬ìš©! ì²´ë ¥ +10\n");
            } else {
                printf("\nâ— í•˜ê¸‰ í¬ì…˜ì´ ì—†ìŠµë‹ˆë‹¤!\n");
            }
            usleep(1000000);
            continue;
        }
        if (input == '2') {
            if (potion2_hp > 0) {
                potion2_hp--;
                playerHP += 30;
                if (playerHP > playerMaxHP) playerHP = playerMaxHP;
                printf("\n ğŸ’™ ì¤‘ê¸‰ í¬ì…˜ ì‚¬ìš©! ì²´ë ¥ +30\n");
            } else {
                printf("\nâ— ì¤‘ê¸‰ í¬ì…˜ì´ ì—†ìŠµë‹ˆë‹¤!\n");
            }
            usleep(1000000);
            continue;
        }
        if (input == '3') {
            if (potion3_hp > 0) {
                potion3_hp--;
                playerHP += 70;
                if (playerHP > playerMaxHP) playerHP = playerMaxHP;
                printf("\n ğŸ’– ìƒê¸‰ í¬ì…˜ ì‚¬ìš©! ì²´ë ¥ +70\n");
            } else {
                printf("\nâ— ìƒê¸‰ í¬ì…˜ì´ ì—†ìŠµë‹ˆë‹¤!\n");
            }
            usleep(1000000);
            continue;
        }
        if (input == 'q' || input == 'Q') {
            break;
        }
        if (input == 'i' || input == 'I') {
            while (1) {

                printf("\033[H\033[J");
                printf("\n-------------------- ì¸ë²¤í† ë¦¬ í™•ì¸ --------------------\n");
                printf("\n");
                printf("              ğŸ’°  ê³¨ë“œ: %dG\n", gold);
                printf("              ğŸ’š  í•˜ê¸‰ ì²´ë ¥ ë¬¼ì•½[ %dê°œ ]\n", potion1_hp);
                printf("                   - ì²´ë ¥ íšŒë³µëŸ‰ + 10 \n\n");
                printf("              ğŸ’™  ì¤‘ê¸‰ ì²´ë ¥ ë¬¼ì•½[ %dê°œ ]\n", potion2_hp);
                printf("                   - ì²´ë ¥ íšŒë³µëŸ‰ + 30 \n\n");
                printf("              ğŸ’–  ìƒê¸‰ ì²´ë ¥ ë¬¼ì•½[ %dê°œ ]\n", potion3_hp);
                printf("                   - ì²´ë ¥ íšŒë³µëŸ‰ + 70 \n\n");
                if (inventory[0] <= 4){
                    printf("              âœ´ï¸  ì—¬ì˜ì£¼ ì¡°ê° : %d ê°œ\n", inventory[0]);
                    printf("                   - 4ì¡°ê°ì„ ëª¨ìœ¼ë©´ ì—¬ì˜ì£¼ê°€ ë©ë‹ˆë‹¤. \n\n");
                }
                if (inventory[9] == 1)  // ì—¬ì˜ì£¼ ì•„ì´í…œì´ ì¸ë²¤í† ë¦¬ì— ìˆìœ¼ë©´ ì¶œë ¥
                    printf("              ğŸ†  ì—¬ì˜ì£¼\n\n");
                if (hasKey == 1) {
                    printf("              ğŸ—ï¸  íˆë“  ë˜ì „ ì—´ì‡ \n");
                }
                printf("\n");
                printf("-------------------------------------------------------\n");
                printf("\n");
                printf("          ( i ) í‚¤ë¥¼ ë‹¤ì‹œ ëˆ„ë¥´ë©´ ëŒì•„ê°‘ë‹ˆë‹¤...\n");

                char temp = getch();
                if (temp == 'i' || temp == 'I') break;
            }
            continue;
        }

        int newX = playerX, newY = playerY;
        if (input == 'A') newY--;
        else if (input == 'B') newY++;
        else if (input == 'D') newX--;
        else if (input == 'C') newX++;

        if (newX >= 0 && newX < COL && newY >= 0 && newY < ROW && map[newY][newX] != '1' && map[newY][newX] != '2') {
            // í”Œë ˆì´ì–´ì™€ ëª¬ìŠ¤í„° ì¶©ëŒ ì²´í¬ (ì¶”ê°€)
            bool hit_monster = false;
            for (int m = 0; m < monsterCount; m++) {
                if (monsters[m].alive && monsters[m].x == newX && monsters[m].y == newY) {
                    playerHP -= 10;
                    if (playerHP < 0) playerHP = 0;
                    hit_monster = true;
                    break;
                }
            }
            if (!hit_monster) {
                playerX = newX;
                playerY = newY;
            }
        }

        if (map[playerY][playerX] == '3') {
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("ğŸŸ¢ ë˜ì „ 1ì— ì…ì¥í•˜ì…¨ìŠµë‹ˆë‹¤...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000); // 1ì´ˆ ëŒ€ê¸°
            memcpy(map, map1, sizeof(map));
            playerX = 1;
            playerY = 18;
            currentMapName = "ë˜ì „ 1";
            monsterCount = 0;
            spawnMonster(10, 5, 0);  // ë‹¬íŒ½ì´
            spawnMonster(15, 10, 0);
            spawnMonster(20, 7, 0);
            spawnMonster(25, 12, 0);
            spawnMonster(30, 9, 0);
        } else if (map[playerY][playerX] == '4') {
            if (!questAccepted[1]) {
                printf("\nâ— í€˜ìŠ¤íŠ¸ 2ë¥¼ ìˆ˜ë½í•´ì•¼ ë˜ì „ 2ì— ì…ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n");
                printf("ì•„ë¬´ í‚¤ë‚˜ ëˆŒëŸ¬ ê³„ì†...\n");
                getch();
                continue;
            }

            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("ğŸ”µ ë˜ì „ 2ì— ì…ì¥í•˜ì…¨ìŠµë‹ˆë‹¤...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000);
            memcpy(map, map2, sizeof(map));
            playerX = 1;
            playerY = 18;
            currentMapName = "ë˜ì „ 2";
            monsterCount = 0;
            spawnMonster(10, 5, 1); // ë„ë§ˆë±€
            spawnMonster(15, 10, 1);
            spawnMonster(20, 7, 1);
            spawnMonster(25, 12, 1);
            spawnMonster(30, 9, 1);
        } else if (map[playerY][playerX] == '5') {
            if (!questAccepted[2]) {
                printf("\nâ— í€˜ìŠ¤íŠ¸ 3ì„ ìˆ˜ë½í•´ì•¼ ë˜ì „ 3ì— ì…ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n");
                printf("ì•„ë¬´ í‚¤ë‚˜ ëˆŒëŸ¬ ê³„ì†...\n");
                getch();
                continue;
            }

            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("ğŸ”´ ë˜ì „ 3ì— ì…ì¥í•˜ì…¨ìŠµë‹ˆë‹¤...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000);
            memcpy(map, map3, sizeof(map));
            playerX = 1;
            playerY = 18;
            currentMapName = "ë˜ì „ 3";
            monsterCount = 0;
            spawnMonster(10, 5, 2); // ë…ê±°ë¯¸
            spawnMonster(15, 10, 2);
            spawnMonster(20, 7, 2);
            spawnMonster(25, 12, 2);
            spawnMonster(30, 9, 2);
        } else if (map[playerY][playerX] == '6') {
            if (hasKey) {
                printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
                printf("ğŸšª íˆë“  ë˜ì „ 4ì— ì…ì¥í•˜ì…¨ìŠµë‹ˆë‹¤...\n\n");
                printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
                usleep(1000000);
                memcpy(map, map4, sizeof(map));
                playerX = 1;
                playerY = 18;
                currentMapName = "ë˜ì „ 4 (íˆë“  ë§µ)";
                monsterCount = 0;
                spawnMonster(14, 8, 3);
            } else {
                printf("\nâ— ì—´ì‡ ê°€ ì—†ì–´ì„œ ë“¤ì–´ê°ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤...\n");
                printf("ì•„ë¬´ í‚¤ë‚˜ ëˆ„ë¥´ë©´ ê³„ì†í•©ë‹ˆë‹¤...\n");
                getch();
            }
        } else if (map[playerY][playerX] == '7') {
            if (!questAccepted[4]) {
                printf("\nâ— ìµœì¢… í€˜ìŠ¤íŠ¸ë¥¼ ìˆ˜ë½í•´ì•¼ ìµœì¢… ë˜ì „ì— ì…ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n");
                printf("ì•„ë¬´ í‚¤ë‚˜ ëˆŒëŸ¬ ê³„ì†...\n");
                getch();
                continue;
            }

            // ë˜ì „ 5 ì…ì¥ ì „ 3ì´ˆ ëŒ€ê¸°
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("âš« ìµœì¢… ë˜ì „ 5ì— ì…ì¥í•˜ì…¨ìŠµë‹ˆë‹¤...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000); // 1ì´ˆ ëŒ€ê¸°

                       
            // ì—¬ì˜ì£¼ ê´€ë ¨ ì•„ì´í…œ êµí™˜ ë° ëŒ€í™”
            if (inventory[0] >= 4) {
                if (a < 30)
                {
                    a = 1;
                }
                
            }

            // ë˜ì „ 5ë¡œ í™”ë©´ ë³€ê²½
            memcpy(map, map5, sizeof(map));
            playerX = 1;
            playerY = 18;
            currentMapName = "ë˜ì „ 5 (ìµœì¢… ë³´ìŠ¤)";
            monsterCount = 0;

            // ëª¬ìŠ¤í„° ìƒì„± ë° ì¶”ê°€
            spawnMonster(10, 5, 4);  // í˜¼í…Œì¼

        } else if (map[playerY][playerX] == '9') {
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            printf("ğŸ¡ ë§ˆì„ë¡œ ëŒì•„ì™”ìŠµë‹ˆë‹¤...\n\n");
            printf("-----------------------------------------------------------------------------------------------------------------------\n\n");
            usleep(1000000);
            memcpy(map, map_backup, sizeof(map));
            playerX = 1;
            playerY = 18;
            currentMapName = "ë§ˆì„";
            monsterCount = 0;
            playerHP = playerMaxHP;  // ğŸ©º ë§ˆì„ ë³µê·€ ì‹œ ì²´ë ¥ ì „ë¶€ íšŒë³µ

        } else if (map[playerY][playerX] == 'c') {
            int nearCasino = 0;
            for (int dy = -1; dy <= 1 && !nearCasino; dy++) {
                for (int dx = -1; dx <= 1 && !nearCasino; dx++) {
                    int ny = playerY + dy;
                    int nx = playerX + dx;
                    if (ny >= 0 && ny < ROW && nx >= 0 && nx < COL && map[ny][nx] == 'c') {
                        nearCasino = 1;
                    }
                }
            }
            if (nearCasino) {
                printf("\nğŸ•Œ ì¹´ì§€ë…¸ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤.\n");
                printf("ê²Œì„ì„ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/N): ");
                fflush(stdout);
                char choice;
                while (1) {
                    choice = getch();
                    if (choice == 'y' || choice == 'Y') {
                        printf("\nì¹´ì§€ë…¸ ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤...\n");
                        usleep(1000000);
                        playCasino(&gold);
                        break;
                    } else if (choice == 'n' || choice == 'N') {
                        printf("\nì¹´ì§€ë…¸ ì…ì¥ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.\n");
                        usleep(1000000);
                        break;
                    } 
                }
                if (map[playerY][playerX + 1] == '0') playerX++;
                else if (map[playerY][playerX - 1] == '0') playerX--;
                else if (map[playerY - 1][playerX] == '0') playerY--;
                else if (map[playerY + 1][playerX] == '0') playerY++;
            }

        } else if (map[playerY][playerX] == 'z') {
            printf("\nğŸ¥ ë¬¼ì•½ìƒì ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤. \n");
            openPotionShop(&gold, &potion1_hp, &potion2_hp, &potion3_hp);
            if (map[playerY][playerX + 1] == '0') playerX++;
            else if (map[playerY][playerX - 1] == '0') playerX--;
            else if (map[playerY - 1][playerX] == '0') playerY--;
            else if (map[playerY + 1][playerX] == '0') playerY++;
            
            
        } else if (map[playerY][playerX] == 'n') {
            // í€˜ìŠ¤íŠ¸ 1 ì™„ë£Œ ì¡°ê±´
            if (questAccepted[0] && !questCompleted[0] &&
                questKillCount[0] >= 10 && questItemCount[0] >= 5) {
                questCompleted[0] = 1;
                rewardGiven[0] = 1;
                gold += 100;
                inventory[0] += 1; // ì—¬ì˜ì£¼ ì¡°ê°
                printf("\nğŸ¤– NPC: â€œí›Œë¥­í•˜ë„¤. ë‹¬íŒ½ì´ ì²˜ì¹˜ì™€ ë“±ê»ì§ˆ ìˆ˜ì§‘ì„ ëª¨ë‘ í•´ëƒˆêµ°.â€\n");
                printf("ğŸ’° ë³´ìƒ: ê³¨ë“œ +100, ì—¬ì˜ì£¼ ì¡°ê° +1\n");
                usleep(1500000);
                playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                playerY = npcY;
                continue; // ë‹¤ë¥¸ ëŒ€ì‚¬ì™€ ê²¹ì¹˜ì§€ ì•Šë„ë¡

            }
            // í€˜ìŠ¤íŠ¸ 2 ì™„ë£Œ ì¡°ê±´
            if (questAccepted[1] && !questCompleted[1] &&
                questKillCount[1] >= 10 && questItemCount[1] >= 5) {
                questCompleted[1] = 1;
                rewardGiven[1] = 1;
                gold += 200;
                inventory[0] += 1; // ì—¬ì˜ì£¼ ì¡°ê°
                printf("\nğŸ¤– NPC: â€œë„ë§ˆë±€ê¹Œì§€ í•´ì¹˜ìš°ë‹¤ë‹ˆ! ì‹¤ë ¥ ì¸ì •í•˜ë„¤.â€\n");
                printf("ğŸ’° ë³´ìƒ: ê³¨ë“œ +200, ì—¬ì˜ì£¼ ì¡°ê° +1\n");
                usleep(1500000);
                playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                playerY = npcY;
                continue; // ë‹¤ë¥¸ ëŒ€ì‚¬ì™€ ê²¹ì¹˜ì§€ ì•Šë„ë¡

            }

            // í€˜ìŠ¤íŠ¸ 3 ì™„ë£Œ ì¡°ê±´
            if (questAccepted[2] && !questCompleted[2] &&
                questKillCount[2] >= 10 && questItemCount[2] >= 5) {
                questCompleted[2] = 1;
                rewardGiven[2] = 1;
                gold += 300;
                inventory[0] += 1; // ì—¬ì˜ì£¼ ì¡°ê°
                printf("\nğŸ¤– NPC: â€œë§¹ë… ê±°ë¯¸ë„ ì²˜ì¹˜í•˜ë‹¤ë‹ˆ, ì´ì   ì§„ì§œ ìš©ì‚¬ ê°™êµ°.â€\n");
                printf("ğŸ’° ë³´ìƒ: ê³¨ë“œ +300, ì—¬ì˜ì£¼ ì¡°ê° +1\n");
                usleep(1500000);
                playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                playerY = npcY;
                continue; // ë‹¤ë¥¸ ëŒ€ì‚¬ì™€ ê²¹ì¹˜ì§€ ì•Šë„ë¡

            }

            // í€˜ìŠ¤íŠ¸ 4 ì™„ë£Œ ì¡°ê±´
            if (questAccepted[3] && !questCompleted[3] &&
                questKillCount[3] >= 1 && questItemCount[3] >= 1) {
                questCompleted[3] = 1;
                rewardGiven[3] = 1;
                gold += 500;
                inventory[0] += 1; // ì—¬ì˜ì£¼ ì¡°ê°
                printf("\nğŸ¤– NPC: â€œë“œë¼í˜ë¼ì˜ ì‹¬ì¥ì„ ì–»ì—ˆë‹¤ë‹ˆ... ëŒ€ë‹¨í•˜êµ°.â€\n");
                printf("ğŸ’° ë³´ìƒ: ê³¨ë“œ +500, ì—¬ì˜ì£¼ ì¡°ê° +1\n");
                usleep(1500000);
                playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                playerY = npcY;
                continue; // ë‹¤ë¥¸ ëŒ€ì‚¬ì™€ ê²¹ì¹˜ì§€ ì•Šë„ë¡

            }

            // í€˜ìŠ¤íŠ¸ 5 ì™„ë£Œ ì¡°ê±´
            if (questAccepted[4] && !questCompleted[4] &&
                questKillCount[4] >= 1 && questItemCount[4] >= 1) {
                questCompleted[4] = 1;
                rewardGiven[4] = 1;
                gold += 1000;
                inventory[4] += 1;
                printf("\nğŸ¤– NPC: â€œí˜¼í…Œì¼ì„ ì“°ëŸ¬ëœ¨ë¦¬ë‹¤ë‹ˆâ€¦ ë³µìˆ˜ëŠ” ì™„ì„±ë˜ì—ˆë„ë‹¤.â€\n");
                printf("ğŸ‰ ìµœì¢… ë³´ìƒ: ê³¨ë“œ +1000, í˜¼í…Œì¼ì˜ ì •ìˆ˜ +1\n");
                usleep(2000000);
                playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                playerY = npcY;
                continue; // ë‹¤ë¥¸ ëŒ€ì‚¬ì™€ ê²¹ì¹˜ì§€ ì•Šë„ë¡

            }
            if (!questAccepted[0]) {
                printf("\nğŸ¤– NPC: â€œê³¤â€¦ ë³µìˆ˜ë¥¼ ìœ„í•´ì„  ë¨¼ì € ëª¸ë¶€í„° ë‹¨ë ¨í•´ì•¼ í•´. ì € ì• ìˆ²ì— ë‹¬íŒ½ì´ ë¬´ë¦¬ë“¤ì´ ë‚˜íƒ€ë‚¬ë‹¤ê³  í•˜ë”êµ°.\n");
                printf("         ë¨¼ì € ê·¸ ë…€ì„ë“¤ë¶€í„° ì²˜ì¹˜í•˜ê³ , ë‹¬íŒ½ì´ ë“±ê»ì§ˆì„ ëª¨ì•„ì™€ ì¤˜.â€\n");
                printf("         â€œë‹¬íŒ½ì´ê°€ ìˆëŠ” ìˆ²ì€ ğŸŸ¢ ì´ë¼ë„¤â€\n");
                printf("\nğŸ“œ í€˜ìŠ¤íŠ¸ë¥¼ ìˆ˜ë½í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/N): ");
                fflush(stdout);

                char q;
                while (1) {
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[0] = 1;
                        printf("\nâœ… í€˜ìŠ¤íŠ¸ 1 [ë‹¬íŒ½ì´ë¥¼ ì£½ì—¬ë¼]ë¥¼ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤!\n");
                        usleep(1500000);
                        playerX = npcX + 1;  // â¬…ï¸ ì´ ì½”ë“œ ì¶”ê°€
                        playerY = npcY;
                        break;
                    } else if (q == 'n' || q == 'N') {
                        printf("\nâ— í€˜ìŠ¤íŠ¸ ìˆ˜ë½ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.\n");
                        usleep(1000000);
                        playerX = npcX + 1;  // â¬…ï¸ ì´ ì½”ë“œ ì¶”ê°€
                        playerY = npcY;
                        break;
                    }
                }
            } else if (questAccepted[0] && questCompleted[0] && !questAccepted[1]) {
                printf("\nğŸ¤– NPC: â€œë‹¬íŒ½ì´ ë”°ìœ„ë¡œëŠ” ë³µìˆ˜ë¥¼ í•  ìˆ˜ ì—†ì–´. ì¢€ ë” ê°•í•œ ì ì„ ìƒëŒ€í•´ì•¼ì§€.\n");
                printf("         ìˆ² ì† ê¹Šì€ ê³³ì— ìˆ² ë„ë§ˆë±€ì´ ì¶œëª°í•œë‹¤ê³  í•˜ë”êµ°.â€\n");
                printf("         â€œë„ë§ˆë±€ì´ ì¶œëª°í•˜ëŠ” ìˆ²ì€ ğŸ”µ ì´ë¼ë„¤â€\n");
                printf("\nğŸ“œ í€˜ìŠ¤íŠ¸ 2 [ìˆ² ë„ë§ˆë±€ì„ ì£½ì—¬ë¼]ë¥¼ ìˆ˜ë½í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/N): ");
                fflush(stdout);

                char q;
                while (1) {
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[1] = 1;
                        printf("\nâœ… í€˜ìŠ¤íŠ¸ 2 [ìˆ² ë„ë§ˆë±€ì„ ì£½ì—¬ë¼]ë¥¼ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤!\n");
                        usleep(1500000);
                        playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                        playerY = npcY;
                        break;
                        
                    } else if (q == 'n' || q == 'N') {
                        printf("\nâ— í€˜ìŠ¤íŠ¸ ìˆ˜ë½ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.\n");
                        usleep(1000000);
                        playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                        playerY = npcY;
                        break;
                    }
                }
            } else if (questAccepted[1] && questCompleted[1] && !questAccepted[2]) {
                printf("\nğŸ¤– NPC: â€œê·¸ëŒ€, ë…ê±°ë¯¸ì˜ ë§¹ë…ë„ ê°ë‹¹í•  ìˆ˜ ìˆì„ê¹Œ? ë˜ì „ 3ì—ì„œ ê¸°ë‹¤ë¦¬ê³  ìˆì„ ê±¸ì„¸.â€\n");
                printf("         â€œë…ê±°ë¯¸ì˜ ë˜ì „ì€ ğŸ”´ ì´ë¼ë„¤â€\n");
                printf("\nğŸ“œ í€˜ìŠ¤íŠ¸ 3 [ë§¹ë… ê±°ë¯¸ë¥¼ ì²˜ì¹˜í•˜ë¼]ë¥¼ ìˆ˜ë½í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/N): ");
                fflush(stdout);
                char q;
                while (1) {
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[2] = 1;
                        printf("\nâœ… í€˜ìŠ¤íŠ¸ 3 [ë§¹ë… ê±°ë¯¸ë¥¼ ì²˜ì¹˜í•˜ë¼]ë¥¼ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤!\n");
                        usleep(1500000);
                        playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                        playerY = npcY;
                        break;
                        
                    } else if (q == 'n' || q == 'N') {
                        printf("\nâ— í€˜ìŠ¤íŠ¸ ìˆ˜ë½ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.\n");
                        usleep(1000000);
                        playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                        playerY = npcY;
                        break;
                    
                    }
                }
            } else if (questAccepted[2] && questCompleted[2] && !questAccepted[3]) {
                printf("\nğŸ¤– NPC: â€œí¡í˜ˆì˜ ì™•, ë“œë¼í˜ë¼ê°€ ê·¸ëŒ€ë¥¼ ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤.â€\n");
                printf("         â€œë…ê±°ë¯¸ì˜ ë˜ì „ìœ¼ë¡œ ë“¤ì–´ê°€ ğŸšª ë¬¸ì„ ì—´ë©´ ë“œë¼í˜ë¼ê°€ ìˆë‹¤ë„¤â€\n");
                printf("\nğŸ“œ í€˜ìŠ¤íŠ¸ 4 [ë“œë¼í˜ë¼ë¥¼ ì²˜ì¹˜í•˜ë¼]ë¥¼ ìˆ˜ë½í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/N): ");
                fflush(stdout);
                char q;
                while (1) {
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[3] = 1;
                        printf("\nâœ… í€˜ìŠ¤íŠ¸ 4 [ë“œë¼í˜ë¼ë¥¼ ì²˜ì¹˜í•˜ë¼]ë¥¼ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤!\n");
                        usleep(1500000);
                        playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                        playerY = npcY;
                        break;
                        
                    } else if (q == 'n' || q == 'N') {
                        printf("\nâ— í€˜ìŠ¤íŠ¸ ìˆ˜ë½ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.\n");
                        usleep(1000000);
                        playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                        playerY = npcY;
                        break;
                        
                    }
                }
            } else if (questAccepted[3] && questCompleted[3] && !questAccepted[4]) {
                printf("\nğŸ¤– NPC: â€œìµœì¢… ë³´ìŠ¤â€¦ í˜¼í…Œì¼ì„ ìƒëŒ€í•  ì¤€ë¹„ê°€ ë˜ì—ˆëŠ”ê°€?â€\n");
                printf("\nğŸ“œ í€˜ìŠ¤íŠ¸ 5 [í˜¼í…Œì¼ì„ ì“°ëŸ¬ëœ¨ë ¤ë¼]ë¥¼ ìˆ˜ë½í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/N): ");
                fflush(stdout);
                char q;
                while (1) {
                    q = getch();
                    if (q == 'y' || q == 'Y') {
                        questAccepted[4] = 1;
                        printf("\nâœ… í€˜ìŠ¤íŠ¸ 5 [í˜¼í…Œì¼ì„ ì“°ëŸ¬ëœ¨ë ¤ë¼]ë¥¼ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤!\n");
                        usleep(1500000);
                        playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                        playerY = npcY;
                        break;
                        
                    } else if (q == 'n' || q == 'N') {
                        printf("\nâ— í€˜ìŠ¤íŠ¸ ìˆ˜ë½ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.\n");
                        usleep(1000000);
                        playerX = npcX + 1;  // NPC ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°•ì œ ì´ë™
                        playerY = npcY;
                        break;
                        
                    }
                }
            } else if (questAccepted[4] && questCompleted[4]) {
                printf("\nğŸ¤– NPC: â€œê·¸ëŒ€ëŠ” ëª¨ë“  ë³µìˆ˜ë¥¼ ì™„ìˆ˜í–ˆë„ë‹¤. ì§„ì •í•œ ìš©ì‚¬ì—¬.â€\n");
                usleep(2000000);
                    // --- ì—”ë”© ìŠ¤í† ë¦¬ ë°ì´í„° ---
                const char** ending_arts[] = {
                    dragonFight, dragonFight, NULL, NULL, NULL, dragon, dragon, NULL
                };
                const int ending_art_lines[] = {
                    sizeof(dragonFight)/sizeof(dragonFight[0]), sizeof(dragonFight)/sizeof(dragonFight[0]), 0, 0, 0,
                    sizeof(dragon)/sizeof(dragon[0]), sizeof(dragon)/sizeof(dragon[0]), 0
                };
                const char* ending_texts[] = {
                    "ê³¤ê³¼ í˜¼í…Œì¼ì˜ ë§ˆì§€ë§‰ ê²°ì „ì€ ì²œë‘¥ì²˜ëŸ¼ ìš¸ë ¤ í¼ì¡Œë‹¤.",
                    "ì¹˜ì—´í•œ ì‹¸ì›€ ëì—, ë§ˆì¹¨ë‚´ ê³¤ì€ í˜¼í…Œì¼ì˜ ìˆ¨í†µì„ ëŠì—ˆë‹¤.",
                    "ì“°ëŸ¬ì§„ í˜¼í…Œì¼ì˜ ëª¸ì—ì„œ ì–´ë‘ ì´ ê±·íˆê³ , ì²œê³µì˜ ë‘¥ì§€ì—ëŠ” ë‹¤ì‹œ í‰í™”ê°€ ì°¾ì•„ì™”ë‹¤.",
                    "ê³¤ì€ ì²œì²œíˆ ë°œê±¸ìŒì„ ì˜®ê²¨, ëª¨ë“  ê²ƒì´ íŒŒê´´ëœ ì²œê³µì˜ ë‘¥ì§€ë¡œ ëŒì•„ê°”ë‹¤.",
                    "ì˜ˆì „ì˜ ë”°ëœ»í•¨ê³¼ ìƒëª…ì´ ê°€ë“í–ˆë˜ ê·¸ê³³ì€ ì´ì œ ì•„ë¬´ê²ƒë„ ë‚¨ì§€ ì•Šì€ í…… ë¹ˆ ê³µê°„ì´ ë˜ì–´ ìˆì—ˆë‹¤.",
                    "ê·¸ëŸ¬ë‚˜ ê³¤ì€ ì•Œì•˜ë‹¤. ê·¸ê³³ì— ë‹´ê¸´ ê¸°ì–µê³¼ ìì‹ ì´ ì§€ì¼œë‚¸ í‰í™”ê°€ ìƒˆë¡œìš´ ì‹œì‘ì„ ìœ„í•œ í¬ë§ì„ì„.",
                    "ì˜¤ë«ë™ì•ˆ ê°€ìŠ´ì†ì— ë§ºí˜”ë˜ ë³µìˆ˜ì˜ ë¬´ê±°ìš´ ì§ì´ ì‚¬ë¼ì§€ê³ , ê³¤ì˜ ëˆˆê°€ì—ëŠ” ì•„í”ˆ ê¸°ì–µê³¼ ìƒˆë¡œìš´ ë‚´ì¼ì— ëŒ€í•œ ë‹¤ì§ì´ í•¨ê»˜ ë§ºí˜”ë‹¤.",
                    "ê·¸ë¦¬í•˜ì—¬ ì–´ë¦° ë“œë˜ê³¤ ê³¤ì˜ ì—¬ì •ì€ ë§ˆì¹¨ë‚´ ëì´ ë‚¬ê³ , ê·¸ì˜ ë§ˆìŒì†ì— ìƒˆë¡­ê²Œ í”¼ì–´ë‚œ í‰í™”ê°€ í•˜ëŠ˜ ë†’ì´ í¼ì ¸ë‚˜ê°”ë‹¤.",
                };
                int ending_frameCount = sizeof(ending_texts) / sizeof(ending_texts[0]);
            
                printf("\033[2J\033[1;1H"); // í™”ë©´ì •ë¦¬
                sleep(1);
                playStory(ending_arts, ending_art_lines, ending_texts, ending_frameCount);
            
                printf("\033[2J\033[1;1H"); // í™”ë©´ì •ë¦¬
                break;
            } else {
                printf("\nğŸ¤– NPC: í˜„ì¬ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” í€˜ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.\n");
                usleep(1000000);
            }
        }

        updateFireballs(map, &playerHP, &playerMaxHP, playerX, playerY);
        updateMonsters(playerX, playerY, map);
        usleep(30000);
    }

    disableRawMode();
    tcsetattr(STDIN_FILENO, TCSANOW, &orig_termios);
    printf("\nê²Œì„ì„ ì¢…ë£Œí•©ë‹ˆë‹¤. \n");
    return 0;
}